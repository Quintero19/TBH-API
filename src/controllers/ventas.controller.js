function a0_0x5b95(_0x37d2da,_0x4d2e26){const _0xb802ff=a0_0xb802();return a0_0x5b95=function(_0x5b95a5,_0x2dfc14){_0x5b95a5=_0x5b95a5-0x17e;let _0x35cfc3=_0xb802ff[_0x5b95a5];return _0x35cfc3;},a0_0x5b95(_0x37d2da,_0x4d2e26);}function a0_0xb802(){const _0x15297b=['cACTw','LIqIE','Método\x20de\x20pago\x20no\x20válido','iaokK','Error\x20al\x20generar\x20reporte\x20mensual','lSKUK','insuficiente','ifnVy','Tallas','PrecioTotal','utdLo','Id_Insumos_Insumo','KTYlN','../models','zckRm','zpaDX','gtgGS','GYmfH','xrpGK','DGORJ','EeidO','MsGzv','BLdvR','CezGw','WkWEH','Detalle\x20de\x20venta\x20es\x20requerido\x20y\x20debe\x20ser\x20un\x20array\x20no\x20vacío','error','Wzqwu','MrYyX','\x20no\x20encontrada','sDFpX',':\x20disponible\x20','Error\x20al\x20verificar\x20insumos\x20del\x20producto','hYzKd','SWElj','Agendamiento\x20no\x20encontrado','qDfEH','reporteVentasMensuales','zrXjU','verificarInsumosProducto','tieneTallas','DFTbG','\x20requiere\x20especificar\x20tallas.\x20Tallas\x20disponibles:\x20','YFcwW','DlGoa','ID\x20de\x20producto\x20es\x20requerido','Error\x20al\x20marcar\x20venta\x20como\x20completada:','JvbrK','iQBfm','Stock\x20insuficiente\x20para\x20insumo\x20general\x20','env','HkDLT','Id_Producto_Tallas_Producto_Talla','Error\x20al\x20marcar\x20venta\x20como\x20completada','NODE_ENV','precio','cKPIK','Stock\x20insuficiente\x20para\x20el\x20producto\x20','Configuración\x20de\x20insumos\x20para\x20producto\x20','rKgOs','WsaII','Id_Ventas','validarStockVenta','toISOString','Tamanos_Data','Nombre_Tamano','no\x20válido','izVVC','Gflsb','between','Tallas_Data','params','Error\x20al\x20listar\x20ventas:','FmaEY','LftPV','IdDsl','push','nHhXP','Id_Producto_Tamano','jidEq','wuJjs','Talla\x20no\x20encontrada','NXuKr','Id_Servicio','Fecha','Tamaño\x20','talla','lUSEg','CUqNN','length','Id_Tallas','Id_Producto_Tamano_Insumos_Producto_Tamano_Insumo','../config/db','string','obtenerTamanosProducto','Error\x20en\x20diagnóstico:','zyjix','toJSON','split','fBlzH','Tobvy','Completada','query','Tallas_Original','\x20no\x20encontrada\x20para\x20el\x20producto\x20','Producto\x20desconocido','NFKOk','dGoeP','9tbpjYv','Cliente\x20no\x20encontrado','parse','Total_Insumos','transaction','\x20configurado','IqTMe','JGcxM','Unidad_Medida','BZvPX','Zfzcv','Detalle_Venta','CqUbH','wENXj','AHKFX','sequelize','verificarConfiguracionInsumosProducto','Precio','commit','Id_Tallas_Talla','ctAdU','KTjzp','JlgXR','Duplicado\x20en\x20campo\x20único','\x20no\x20encontrado','xFdUJ','2475145SCvPDo','ScvyP','Error\x20al\x20anular\x20venta:\x20','Error\x20al\x20obtener\x20venta\x20por\x20ID:','La\x20venta\x20debe\x20tener\x20estado\x203\x20(pendiente)\x20para\x20poder\x20marcarla\x20como\x20completada','MBAuw','qLHHg','cgXMf','Jcjts','Error\x20al\x20generar\x20reporte\x20mensual:','AfUok','zumga','descripcionTallas','Aetrc','ThhrG','Error\x20al\x20anular\x20venta:','CKKHO','Nombre\x20de\x20tamaño\x20no\x20válido\x20para\x20el\x20producto\x20','development',',\x20solicitado\x20','gSbgj','update','El\x20producto\x20','\x20x\x20','DFQiQ','obtenerTallasProducto','360908knRUHP','Error\x20al\x20generar\x20reporte\x20diario:','amDVn','Cbafr','XCkBM','map','Fecha_Anulacion','total','Nombre\x20de\x20talla\x20no\x20válido\x20para\x20el\x20producto\x20','set','yIQXx','axDkC','cQsha','Producto\x20con\x20ID\x20','N/A','Btarr','TDXud','wNTBI','Id_Producto_Tamano_Insumos','sIYDW','\x20del\x20producto\x20','NAyKs','Id_Empleados','eFjhP','Conflicto\x20de\x20datos\x20únicos','Estado','HbMja','aIkcA','Error\x20al\x20anular\x20venta','reporteVentasDiarias','372686gxdEzB','message','body','jeTqM','Talla','listarVentas','Cantidad_Consumo','diagnosticarInsumosTamaño','WROVt','Tamanos','anularVenta','Uisfw',',\x20Solicitado:\x20','VLUiV','xNvKZ','Servicio','descripcion','UxfIM','Producto\x20no\x20encontrado','YQngP','Nombre\x20del\x20tamaño\x20es\x20requerido','Id_Productos','CIouw','UqEbv','status','Desconocido','BlmTn','Subtotal','todjP','\x20unidades','UAmMq','bJSvH','sort','Jyqqr','BKEWb','getFullYear','Total','no\x20encontrado','tNwJY','marcarVentaCompletada','UsxcU','La\x20venta\x20debe\x20tener\x20estado\x203\x20(pendiente)\x20para\x20poder\x20anularla','La\x20transferencia\x20requiere\x20número\x20de\x20referencia','rollback','nombre','values','FQovb','trim','NmkSo','THyBX','Anulada','iaXCV','qBAfF','uGJrn','ooyKh','sjEdt','kiixa','frokx','bSfSl','Error\x20al\x20crear\x20venta:','BwBfR','yKUrk','RydpA','eRCOQ','Error\x20al\x20generar\x20reporte\x20diario','Error\x20de\x20validación','isArray','Error\x20al\x20validar\x20stock\x20de\x20venta:','uWGqk','Talla\x20','5|4|6|3|0|1|2','VpMLJ','Cantidad','MviuZ','Error\x20al\x20validar\x20stock','findOne','11184593OUtmfE','Venta\x20marcada\x20como\x20completada\x20correctamente','obtenerTamanoPorNombre','Error\x20de\x20base\x20de\x20datos','producto','forEach','Stock\x20insuficiente\x20para\x20talla\x20','34070697wkFRtb','kTVzt','toString','uvEoV','json','Id_Cliente','getMonth','validarStock','RbxTI','vnnpe','twPqe','Fecha_Completado','LcYNq','Id_Productos_Producto','1CXLiRz','LWUqF','qHgVy','detalleTalla','rLpWp','jSEcr','findAll','Denwy','nEZFH','tamaño','general','Error\x20al\x20obtener\x20ventas:\x20','Venta\x20anulada\x20correctamente','toFixed','XDHPt','success','OoflY','\x20tamaño(s)\x20sin\x20insumos\x20configurados:\x20','dpGcv','qncEQ','Id_Tamano','KRliC','cantidad','MshSC','Nombre','Error\x20al\x20actualizar\x20stock:\x20','slice','Id_Insumos','EHnXM','DbcBv','bjPvw','Precio_Venta','xzbkA','\x20no\x20tiene\x20el\x20tamaño\x20','Error\x20al\x20obtener\x20venta','KIhka','Id_Empleados_Empleado','Id_Categoria_Insumos','mIOuh','ILEHq','QKEVn','Tamaño\x20no\x20configurado\x20para\x20este\x20producto','Venta\x20no\x20encontrada','Error\x20inesperado\x20al\x20crear\x20venta','Cantidad_Maxima','Id_Agendamientos','UCDTq','sBAIL','Producto\x20requiere\x20tallas','Tamanos_Data_Original','BBTnO','create','UhTaR','eLRaX','Error\x20al\x20verificar\x20configuración\x20de\x20insumos:','Tamaño\x20no\x20encontrado','includes','Id_Producto_Tallas','LEkaT','PxIfe','xeptM','7913610wLxTYZ','LtIZG','RXMAx','Tamanos_Original','iTuni','Transferencia','XWduk','aGysB','\x20x\x20Talla\x20','join','397560YfXNTj','bOYnm','PRujF','OOFkY','SNPPN','aXiTd','Stock','no\x20coincide','.\x20Disponible:\x20','filter','cvsNz','hoMUO','TVOFj','EMrUT','gHHne','vblQE','Insumos\x20configurados\x20para\x20producto\x20','getDate','Producto_Tamano_Insumos','QOjVZ','Id_Agendamientos_Agendamiento','eWHBB','lgVBR','M_Pago','stringify','mDQRF','Tallas_Data_Original','has',',\x20Necesario:\x20','descripcionTamanos','Error\x20al\x20validar\x20stock:\x20','XuKeh','findByPk','Stock\x20insuficiente\x20para\x20fragancia\x20','fragancia','fKgpF','DoVsE','ujpqR','Id_Tamano_Tamano','PxMdu','obtenerVentaPorId','reduce','dPOCP','tieneTamanos','Referencia','uGRax','boQuL','hpsde'];a0_0xb802=function(){return _0x15297b;};return a0_0xb802();}const a0_0x473939=a0_0x5b95;(function(_0x4ce3f7,_0x1e2d4f){const _0x1ce45c=a0_0x5b95,_0x697de7=_0x4ce3f7();while(!![]){try{const _0x126587=parseInt(_0x1ce45c(0x210))/0x1*(-parseInt(_0x1ce45c(0x1af))/0x2)+-parseInt(_0x1ce45c(0x2f3))/0x3*(parseInt(_0x1ce45c(0x191))/0x4)+parseInt(_0x1ce45c(0x30d))/0x5+-parseInt(_0x1ce45c(0x24d))/0x6+-parseInt(_0x1ce45c(0x1fb))/0x7+parseInt(_0x1ce45c(0x257))/0x8+parseInt(_0x1ce45c(0x202))/0x9;if(_0x126587===_0x1e2d4f)break;else _0x697de7['push'](_0x697de7['shift']());}catch(_0xb2eaa0){_0x697de7['push'](_0x697de7['shift']());}}}(a0_0xb802,0xe98b7));const {Ventas,Detalle_Venta,Productos,Producto_Tallas,Producto_Tamano_Insumos,Producto_Tamano,Tamano,Tamano_Insumos,Tallas,Agendamientos,Empleados,Servicios,Clientes,Insumos}=require(a0_0x473939(0x294)),{sequelize}=require(a0_0x473939(0x2e3)),{UniqueConstraintError,ValidationError,DatabaseError}=require(a0_0x473939(0x302)),validarCliente=async(_0xfe31a6,_0x5bb0a)=>{const _0x509fc5=a0_0x473939,_0x589be9={'QKEVn':_0x509fc5(0x2f4)},_0x56ee41=await Clientes['findByPk'](_0xfe31a6,{'transaction':_0x5bb0a});if(!_0x56ee41)throw new Error(_0x589be9[_0x509fc5(0x238)]);return _0x56ee41;},validarEmpleado=async(_0x342b4b,_0x48f9fa)=>{const _0x53088c=a0_0x473939,_0x1e20aa={'kTVzt':'Empleado\x20no\x20encontrado'},_0x5af042=await Empleados['findByPk'](_0x342b4b,{'transaction':_0x48f9fa});if(!_0x5af042)throw new Error(_0x1e20aa[_0x53088c(0x203)]);return _0x5af042;},validarMetodoPago=(_0x20aa10,_0x129008)=>{const _0x129112=a0_0x473939,_0x481640={'bgqDK':'Efectivo','rKgOs':'Tarjeta','aIkcA':_0x129112(0x252),'hoMUO':_0x129112(0x289),'oIDnu':function(_0xcc138f,_0x2f809f){return _0xcc138f===_0x2f809f;}},_0x225627=[_0x481640['bgqDK'],_0x481640[_0x129112(0x2c2)],_0x481640[_0x129112(0x1ac)],'PSE'];if(!_0x225627[_0x129112(0x248)](_0x20aa10))throw new Error(_0x481640[_0x129112(0x262)]);if(_0x481640['oIDnu'](_0x20aa10,_0x481640[_0x129112(0x1ac)])&&!_0x129008)throw new Error(_0x129112(0x1d9));},calcularPrecio=async(_0xa0708f,_0x3d51b7,_0x8e39af,_0x35c389,_0x2a509d)=>{const _0x1ccfcf=a0_0x473939,_0x54c380={'XCkBM':function(_0x1a4c8a,_0x54b3c7){return _0x1a4c8a(_0x54b3c7);},'vEQSe':function(_0x39dd0b,_0x2248d1){return _0x39dd0b>_0x2248d1;},'bSfSl':function(_0x59f002,_0x1eb294){return _0x59f002*_0x1eb294;},'BLdvR':function(_0x32def3,_0x57fbf8){return _0x32def3(_0x57fbf8);},'THyBX':function(_0x505fde,_0x537ee3){return _0x505fde(_0x537ee3);},'KRliC':function(_0x44a274,_0x3f6730){return _0x44a274>_0x3f6730;},'cvsNz':function(_0x22734d,_0x51a7ac){return _0x22734d*_0x51a7ac;},'amDVn':function(_0x729492,_0x466ad1){return _0x729492*_0x466ad1;}};let _0x776e3a=0x0;try{if(_0x8e39af&&_0x8e39af[_0x1ccfcf(0x2e0)]>0x0)for(const _0x375e96 of _0x8e39af){const _0x3e531c=Number(_0x375e96[_0x1ccfcf(0x290)]||0x0);_0x776e3a+=_0x3e531c;}else{if(_0x3d51b7&&_0x54c380['vEQSe'](_0x3d51b7[_0x1ccfcf(0x2e0)],0x0))for(const _0x515ee0 of _0x3d51b7){const _0x592adb=await Producto_Tallas[_0x1ccfcf(0x1fa)]({'where':{'Id_Productos':_0xa0708f['Id_Productos'],'Talla':_0x515ee0['talla']},'transaction':_0x2a509d});if(_0x592adb){const _0xb75814=_0x54c380[_0x1ccfcf(0x1e9)](Number(_0xa0708f['Precio_Venta'])+_0x54c380[_0x1ccfcf(0x195)](Number,_0x592adb[_0x1ccfcf(0x304)]),_0x515ee0[_0x1ccfcf(0x226)]);_0x776e3a+=_0xb75814;}else{const _0x284719=_0x54c380[_0x1ccfcf(0x1e9)](_0x54c380[_0x1ccfcf(0x29d)](Number,_0xa0708f[_0x1ccfcf(0x22f)]),_0x515ee0[_0x1ccfcf(0x226)]);_0x776e3a+=_0x284719;}}else _0x776e3a=Number(_0xa0708f[_0x1ccfcf(0x22f)])*_0x35c389;}(!_0x776e3a||_0x54c380[_0x1ccfcf(0x1e0)](isNaN,_0x776e3a))&&(_0x8e39af&&_0x54c380[_0x1ccfcf(0x225)](_0x8e39af[_0x1ccfcf(0x2e0)],0x0)?_0x776e3a=_0x8e39af[_0x1ccfcf(0x280)]((_0x169a33,_0x2c58d5)=>{const _0x48b658=_0x1ccfcf,_0x1b52e5=_0x54c380['XCkBM'](Number,_0x2c58d5[_0x48b658(0x290)]||0x0);return _0x169a33+_0x1b52e5;},0x0):_0x776e3a=_0x54c380[_0x1ccfcf(0x261)](_0x54c380[_0x1ccfcf(0x195)](Number,_0xa0708f[_0x1ccfcf(0x22f)]),_0x35c389));}catch(_0x299846){_0x776e3a=_0x54c380[_0x1ccfcf(0x193)](_0x54c380[_0x1ccfcf(0x29d)](Number,_0xa0708f['Precio_Venta']),_0x35c389);}return _0x776e3a;},actualizarStockProducto=async(_0x280c9b,_0x15606d,_0x24a54b)=>{const _0x59797b=a0_0x473939,_0x3f4516={'UqEbv':function(_0x4a130f,_0x3070e1){return _0x4a130f(_0x3070e1);},'vkAhZ':function(_0x55971b,_0xcff0d8){return _0x55971b-_0xcff0d8;}},_0xbdcf=await Productos['findByPk'](_0x280c9b,{'transaction':_0x24a54b});if(!_0xbdcf)throw new Error('Producto\x20con\x20ID\x20'+_0x280c9b+_0x59797b(0x30b));const _0x3b0e9d=_0x3f4516[_0x59797b(0x1c6)](Number,_0xbdcf[_0x59797b(0x25d)]||0x0),_0x4da2f2=_0x3f4516['vkAhZ'](_0x3b0e9d,_0x15606d);if(_0x4da2f2<0x0)throw new Error(_0x59797b(0x2c0)+_0xbdcf[_0x59797b(0x228)]+_0x59797b(0x25f)+_0x3b0e9d+_0x59797b(0x1bb)+_0x15606d);return await _0xbdcf['update']({'Stock':_0x4da2f2},{'transaction':_0x24a54b}),_0x4da2f2;},actualizarStockTallas=async(_0x2b2f09,_0x52de52,_0x543693)=>{const _0x5bba31=a0_0x473939,_0x5b11a3={'hYzKd':function(_0xcab593,_0x3041b2){return _0xcab593(_0x3041b2);},'uWGqk':function(_0x526394,_0xe7f180){return _0x526394(_0xe7f180);},'iaXCV':function(_0x445a0d,_0x28e9f9){return _0x445a0d-_0x28e9f9;},'WROVt':function(_0x149c4a,_0x1f1cdd){return _0x149c4a<_0x1f1cdd;}};for(const _0x5b0df4 of _0x52de52){const _0x20d9c3=_0x5b0df4[_0x5bba31(0x2dd)]||_0x5b0df4[_0x5bba31(0x1b3)]||_0x5b0df4[_0x5bba31(0x1db)]||'';if(!_0x20d9c3)throw new Error(_0x5bba31(0x199)+_0x2b2f09);const _0x4e8eb1=await Tallas[_0x5bba31(0x1fa)]({'where':{'Nombre':_0x20d9c3},'transaction':_0x543693});if(!_0x4e8eb1)throw new Error(_0x5bba31(0x1f4)+_0x20d9c3+_0x5bba31(0x2a4));const _0x54a078=await Producto_Tallas[_0x5bba31(0x1fa)]({'where':{'Id_Productos':_0x2b2f09,'Id_Tallas':_0x4e8eb1['Id_Tallas']},'transaction':_0x543693});if(!_0x54a078)throw new Error(_0x5bba31(0x1f4)+_0x20d9c3+_0x5bba31(0x2ef)+_0x2b2f09);const _0x408aa3=_0x5b11a3[_0x5bba31(0x2a8)](Number,_0x54a078[_0x5bba31(0x25d)]||0x0),_0x100bad=_0x5b11a3[_0x5bba31(0x1f3)](Number,_0x5b0df4[_0x5bba31(0x226)]||_0x5b0df4['Cantidad']||0x0),_0x301cec=_0x5b11a3[_0x5bba31(0x1e2)](_0x408aa3,_0x100bad);if(_0x5b11a3[_0x5bba31(0x1b7)](_0x301cec,0x0))throw new Error('Stock\x20insuficiente\x20para\x20talla\x20'+_0x20d9c3+'.\x20Disponible:\x20'+_0x408aa3+',\x20Solicitado:\x20'+_0x100bad);await _0x54a078[_0x5bba31(0x18c)]({'Stock':_0x301cec},{'transaction':_0x543693});}},actualizarStockInsumos=async(_0xf987dd,_0x124db1,_0x3910c5)=>{const _0x39be79=a0_0x473939,_0x15eec5={'NmkSo':_0x39be79(0x292),'cwgAg':function(_0x4f87be,_0x36ea9f){return _0x4f87be(_0x36ea9f);},'IScpF':function(_0x103781,_0x76c407){return _0x103781(_0x76c407);},'BwBfR':function(_0x4236a6,_0x202fe1){return _0x4236a6*_0x202fe1;},'fBlzH':function(_0x2a447f,_0x41fa14){return _0x2a447f(_0x41fa14);},'KIhka':function(_0x4c997c,_0x4b216b){return _0x4c997c-_0x4b216b;},'frokx':function(_0x810fee,_0x17ab6c){return _0x810fee<_0x17ab6c;},'bjPvw':function(_0x44ae82,_0x2f7bad){return _0x44ae82(_0x2f7bad);}};for(const _0x525d2a of _0x124db1){const _0x43221d=_0x525d2a['nombre']||_0x525d2a[_0x39be79(0x228)]||'';if(!_0x43221d)throw new Error(_0x39be79(0x188)+_0xf987dd);const _0x40ac8d=await Tamano[_0x39be79(0x1fa)]({'where':{'Nombre':_0x43221d},'transaction':_0x3910c5});if(!_0x40ac8d)throw new Error('Tamaño\x20'+_0x43221d+_0x39be79(0x30b));const _0x24386a=await Producto_Tamano[_0x39be79(0x1fa)]({'where':{'Id_Productos':_0xf987dd,'Id_Tamano':_0x40ac8d['Id_Tamano']},'transaction':_0x3910c5});if(!_0x24386a)throw new Error('El\x20producto\x20'+_0xf987dd+_0x39be79(0x231)+_0x525d2a[_0x39be79(0x1db)]+_0x39be79(0x2f8));const _0x112d6f=await Producto_Tamano_Insumos[_0x39be79(0x216)]({'where':{'Id_Producto_Tamano':_0x24386a[_0x39be79(0x2d5)]},'include':[{'model':Insumos,'as':_0x15eec5[_0x39be79(0x1df)]}],'transaction':_0x3910c5}),_0x2a613e=await Tamano_Insumos[_0x39be79(0x216)]({'where':{'Id_Tamano':_0x40ac8d[_0x39be79(0x224)]},'include':[{'model':Insumos,'as':_0x39be79(0x292)}],'transaction':_0x3910c5}),_0x4ac39f=_0x15eec5['cwgAg'](Number,_0x525d2a[_0x39be79(0x1f7)]||_0x525d2a[_0x39be79(0x226)]||0x0),_0x136234=new Map();for(const _0x510154 of _0x112d6f){const _0x342b96=_0x510154['Id_Insumos_Insumo'],_0x443489=_0x15eec5['IScpF'](Number,_0x510154[_0x39be79(0x1b5)]||0x0),_0x432c04=_0x15eec5[_0x39be79(0x1eb)](_0x443489,_0x4ac39f),_0xff89cf=_0x15eec5[_0x39be79(0x2ea)](Number,_0x342b96['Stock']||0x0),_0x1ef41a=_0x15eec5[_0x39be79(0x233)](_0xff89cf,_0x432c04);if(_0x15eec5[_0x39be79(0x1e8)](_0x1ef41a,0x0))throw new Error('Stock\x20insuficiente\x20para\x20fragancia\x20'+_0x342b96[_0x39be79(0x228)]+_0x39be79(0x25f)+_0xff89cf+_0x39be79(0x273)+_0x432c04+'\x20('+_0x443489+_0x39be79(0x18e)+_0x4ac39f+')');await _0x342b96[_0x39be79(0x18c)]({'Stock':_0x1ef41a},{'transaction':_0x3910c5}),_0x136234[_0x39be79(0x19a)](_0x342b96[_0x39be79(0x22b)],!![]);}for(const _0x37ebfb of _0x2a613e){const _0x18208e=_0x37ebfb['Id_Insumos_Insumo'];if(_0x136234['has'](_0x18208e['Id_Insumos']))continue;const _0x2a0bda=_0x15eec5[_0x39be79(0x22e)](Number,_0x37ebfb[_0x39be79(0x1f7)]||0x0),_0x485fe4=_0x15eec5[_0x39be79(0x1eb)](_0x2a0bda,_0x4ac39f),_0x55b156=Number(_0x18208e[_0x39be79(0x25d)]||0x0),_0x25be6b=_0x55b156-_0x485fe4;if(_0x15eec5[_0x39be79(0x1e8)](_0x25be6b,0x0))throw new Error(_0x39be79(0x2b8)+_0x18208e[_0x39be79(0x228)]+_0x39be79(0x25f)+_0x55b156+_0x39be79(0x273)+_0x485fe4+'\x20('+_0x2a0bda+_0x39be79(0x18e)+_0x4ac39f+')');await _0x18208e[_0x39be79(0x18c)]({'Stock':_0x25be6b},{'transaction':_0x3910c5});}}};exports[a0_0x473939(0x2ae)]=async(_0x24be9a,_0x3e6e39)=>{const _0x5cd9e3=a0_0x473939,_0x3aa978={'NXuKr':_0x5cd9e3(0x2a1),'DoVsE':_0x5cd9e3(0x292),'JlgXR':_0x5cd9e3(0x21f),'UsxcU':'Error\x20al\x20verificar\x20insumos:','Gflsb':_0x5cd9e3(0x2a7)};try{const {idProducto:_0x27f569,nombreTamano:_0x531010}=_0x24be9a[_0x5cd9e3(0x2ce)],_0x125b35=await Tamano[_0x5cd9e3(0x1fa)]({'where':{'Nombre':_0x531010}});if(!_0x125b35)return _0x3e6e39[_0x5cd9e3(0x1c7)](0x194)[_0x5cd9e3(0x206)]({'status':_0x3aa978['NXuKr'],'message':'Tamaño\x20'+_0x531010+_0x5cd9e3(0x30b)});const _0x17c5ce=await Producto_Tamano['findOne']({'where':{'Id_Productos':_0x27f569,'Id_Tamano':_0x125b35[_0x5cd9e3(0x224)]}});if(!_0x17c5ce)return _0x3e6e39[_0x5cd9e3(0x1c7)](0x194)[_0x5cd9e3(0x206)]({'status':_0x3aa978[_0x5cd9e3(0x2d9)],'message':_0x5cd9e3(0x18d)+_0x27f569+'\x20no\x20tiene\x20el\x20tamaño\x20'+_0x531010+_0x5cd9e3(0x2f8)});const _0x12fe53=await Producto_Tamano_Insumos[_0x5cd9e3(0x216)]({'where':{'Id_Producto_Tamano':_0x17c5ce[_0x5cd9e3(0x2d5)]},'include':[{'model':Insumos,'as':_0x3aa978[_0x5cd9e3(0x27b)]}]}),_0x38333b=_0x12fe53[_0x5cd9e3(0x196)](_0x1744d1=>({'Id_Insumo':_0x1744d1[_0x5cd9e3(0x292)][_0x5cd9e3(0x22b)],'Nombre':_0x1744d1['Id_Insumos_Insumo'][_0x5cd9e3(0x228)],'Stock_Actual':_0x1744d1[_0x5cd9e3(0x292)][_0x5cd9e3(0x25d)],'Cantidad_Consumo':_0x1744d1[_0x5cd9e3(0x1b5)],'Unidad_Medida':_0x1744d1['Id_Insumos_Insumo']['Unidad_Medida']}));_0x3e6e39['json']({'status':_0x3aa978[_0x5cd9e3(0x309)],'message':_0x5cd9e3(0x267)+_0x27f569+',\x20tamaño\x20'+_0x531010,'data':{'Id_Producto':_0x27f569,'Id_Tamano':_0x125b35[_0x5cd9e3(0x224)],'Nombre_Tamano':_0x531010,'Id_Producto_Tamano':_0x17c5ce['Id_Producto_Tamano'],'Total_Insumos':_0x38333b[_0x5cd9e3(0x2e0)],'Insumos':_0x38333b}});}catch(_0x2252eb){console[_0x5cd9e3(0x2a1)](_0x3aa978[_0x5cd9e3(0x1d7)],_0x2252eb),_0x3e6e39[_0x5cd9e3(0x1c7)](0x1f4)['json']({'status':_0x3aa978[_0x5cd9e3(0x2d9)],'message':_0x3aa978[_0x5cd9e3(0x2cb)],'detail':_0x2252eb[_0x5cd9e3(0x1b0)]});}},exports[a0_0x473939(0x1b4)]=async(_0x257c18,_0x4751b4)=>{const _0x421a7c=a0_0x473939,_0x2e90b1={'sjEdt':function(_0x27450d,_0x315370){return _0x27450d>_0x315370;},'yKUrk':function(_0x2d1ac3,_0x6b5af7){return _0x2d1ac3(_0x6b5af7);},'nHhXP':function(_0xd1fba4,_0x526b91){return _0xd1fba4===_0x526b91;},'FQovb':_0x421a7c(0x2fe),'eRCOQ':_0x421a7c(0x20f),'CQCfP':_0x421a7c(0x2bb),'utdLo':_0x421a7c(0x2e2),'fKgpF':_0x421a7c(0x26b),'zyjix':_0x421a7c(0x234),'uNAWG':_0x421a7c(0x1a7),'kiixa':_0x421a7c(0x228),'AfUok':_0x421a7c(0x21f),'bOYnm':_0x421a7c(0x2cf),'bJSvH':_0x421a7c(0x2a1)};try{const _0xa3a613=await Ventas['findAll']({'include':[{'model':Detalle_Venta,'as':_0x2e90b1[_0x421a7c(0x1dd)],'include':[{'model':Productos,'as':_0x2e90b1[_0x421a7c(0x1ee)]},{'model':Producto_Tallas,'as':_0x2e90b1['CQCfP']},{'model':Producto_Tamano_Insumos,'as':_0x2e90b1[_0x421a7c(0x291)]},{'model':Servicios,'as':_0x421a7c(0x1be)}]},{'model':Agendamientos,'as':_0x2e90b1[_0x421a7c(0x27a)],'required':![]},{'model':Empleados,'as':_0x2e90b1[_0x421a7c(0x2e7)],'attributes':[_0x2e90b1['uNAWG'],_0x2e90b1[_0x421a7c(0x1e7)]]}]}),_0x13502b=_0xa3a613[_0x421a7c(0x196)](_0x578334=>{const _0x277fd5=_0x421a7c,_0x56cd36={'lSKUK':function(_0x57ef1a,_0x14edc5){const _0x5280c1=a0_0x5b95;return _0x2e90b1[_0x5280c1(0x1e6)](_0x57ef1a,_0x14edc5);}},_0x25e1d1=_0x578334['toJSON'](),_0x485d03=_0x25e1d1[_0x277fd5(0x2fe)]||[],_0x183bcf=_0x25e1d1[_0x277fd5(0x26b)]||null,_0x7db2ce=_0x25e1d1[_0x277fd5(0x234)]||{},_0x20ec4c=_0x485d03['map'](_0x548d66=>{const _0x46b2b5=_0x277fd5,_0x4843a0={..._0x548d66};if(_0x548d66[_0x46b2b5(0x2cd)])try{_0x4843a0[_0x46b2b5(0x28f)]=JSON[_0x46b2b5(0x2f5)](_0x548d66[_0x46b2b5(0x2cd)]);}catch(_0x6378fd){_0x4843a0[_0x46b2b5(0x28f)]=[];}else _0x4843a0[_0x46b2b5(0x28f)]=[];if(_0x548d66[_0x46b2b5(0x2c7)])try{_0x4843a0[_0x46b2b5(0x1b8)]=JSON['parse'](_0x548d66['Tamanos_Data']);}catch(_0x1d0277){_0x4843a0[_0x46b2b5(0x1b8)]=[];}else _0x4843a0[_0x46b2b5(0x1b8)]=[];return _0x4843a0[_0x46b2b5(0x2af)]=_0x4843a0[_0x46b2b5(0x28f)]&&_0x56cd36[_0x46b2b5(0x28c)](_0x4843a0['Tallas'][_0x46b2b5(0x2e0)],0x0),_0x4843a0[_0x46b2b5(0x282)]=_0x4843a0[_0x46b2b5(0x1b8)]&&_0x4843a0['Tamanos'][_0x46b2b5(0x2e0)]>0x0,_0x4843a0[_0x46b2b5(0x2af)]&&(_0x4843a0[_0x46b2b5(0x183)]=_0x4843a0[_0x46b2b5(0x28f)][_0x46b2b5(0x196)](_0x323897=>(_0x323897[_0x46b2b5(0x226)]||_0x323897[_0x46b2b5(0x1f7)]||0x0)+'\x20x\x20Talla\x20'+(_0x323897['talla']||_0x323897[_0x46b2b5(0x1b3)]||_0x323897['nombre']||_0x46b2b5(0x19f)))[_0x46b2b5(0x256)](',\x20')),_0x4843a0[_0x46b2b5(0x282)]&&(_0x4843a0[_0x46b2b5(0x274)]=_0x4843a0['Tamanos'][_0x46b2b5(0x196)](_0x43235b=>_0x43235b[_0x46b2b5(0x1f7)]+_0x46b2b5(0x18e)+_0x43235b[_0x46b2b5(0x1db)])[_0x46b2b5(0x256)](',\x20')),_0x4843a0;}),_0x27902b=_0x20ec4c['reduce']((_0xd55497,_0x5d8ccb)=>_0xd55497+Number(_0x5d8ccb[_0x277fd5(0x1ca)]||0x0),0x0),_0x294829=_0x183bcf?_0x2e90b1[_0x277fd5(0x1ec)](Number,_0x183bcf[_0x277fd5(0x1ca)]||0x0):0x0,_0x1fbf1d=_0x27902b+_0x294829,_0x6189e6=_0x2e90b1[_0x277fd5(0x2d4)](_0x2e90b1[_0x277fd5(0x1ec)](Number,_0x25e1d1[_0x277fd5(0x1d3)]),_0x1fbf1d);return{'Id_Ventas':_0x25e1d1['Id_Ventas'],'Id_Agendamientos':_0x25e1d1[_0x277fd5(0x23d)],'Id_Cliente':_0x25e1d1[_0x277fd5(0x207)],'Id_Empleados':_0x25e1d1[_0x277fd5(0x1a7)],'Nombre_Empleado':_0x7db2ce?.['Nombre']||_0x277fd5(0x1c8),'Fecha':_0x25e1d1['Fecha'],'Total':_0x25e1d1[_0x277fd5(0x1d3)],'Estado':_0x25e1d1['Estado'],'M_Pago':_0x25e1d1['M_Pago'],'Referencia':_0x25e1d1['Referencia'],'Detalle_Venta':_0x20ec4c,'tieneAgendamiento':!!_0x25e1d1[_0x277fd5(0x23d)],'Agendamiento':_0x183bcf,'totalValidado':_0x6189e6};});_0x4751b4['json']({'status':_0x2e90b1[_0x421a7c(0x181)],'data':_0x13502b});}catch(_0x28b67f){console[_0x421a7c(0x2a1)](_0x2e90b1[_0x421a7c(0x258)],_0x28b67f),_0x4751b4['status'](0x1f4)[_0x421a7c(0x206)]({'status':_0x2e90b1[_0x421a7c(0x1ce)],'message':process[_0x421a7c(0x2b9)]['NODE_ENV']===_0x421a7c(0x189)?_0x421a7c(0x21b)+_0x28b67f[_0x421a7c(0x1b0)]:'Error\x20al\x20obtener\x20ventas'});}},exports[a0_0x473939(0x27f)]=async(_0xf1fab5,_0x43f765)=>{const _0x24ba33=a0_0x473939,_0x105f0c={'jidEq':function(_0x244fea,_0x13e508){return _0x244fea>_0x13e508;},'WRpsK':'Detalle_Venta','goijM':_0x24ba33(0x20f),'xFdUJ':_0x24ba33(0x2bb),'JvbrK':_0x24ba33(0x2e2),'lQfLj':'Servicio','QscQa':_0x24ba33(0x26b),'GYmfH':_0x24ba33(0x234),'fwJRI':_0x24ba33(0x228),'zckRm':_0x24ba33(0x2a1),'WiKPb':_0x24ba33(0x23a),'Aetrc':function(_0x4a5f92,_0x2d7246){return _0x4a5f92(_0x2d7246);},'gtgGS':function(_0x606402,_0x4c1a7f){return _0x606402+_0x4c1a7f;},'UhTaR':function(_0x1111bd,_0x1685bd){return _0x1111bd===_0x1685bd;},'CezGw':_0x24ba33(0x21f),'xrpGK':_0x24ba33(0x310),'dpGcv':_0x24ba33(0x232)};try{const {id:_0x8abd05}=_0xf1fab5[_0x24ba33(0x2ce)],_0x1219b1=await Ventas[_0x24ba33(0x277)](_0x8abd05,{'include':[{'model':Detalle_Venta,'as':_0x105f0c['WRpsK'],'include':[{'model':Productos,'as':_0x105f0c['goijM']},{'model':Producto_Tallas,'as':_0x105f0c[_0x24ba33(0x30c)]},{'model':Producto_Tamano_Insumos,'as':_0x105f0c[_0x24ba33(0x2b6)]},{'model':Servicios,'as':_0x105f0c['lQfLj']}]},{'model':Agendamientos,'as':_0x105f0c['QscQa'],'required':![]},{'model':Empleados,'as':_0x105f0c[_0x24ba33(0x298)],'attributes':[_0x105f0c['fwJRI']]}]});if(!_0x1219b1)return _0x43f765[_0x24ba33(0x1c7)](0x194)['json']({'status':_0x105f0c[_0x24ba33(0x295)],'message':_0x105f0c['WiKPb']});const _0x31ca9a=_0x1219b1[_0x24ba33(0x2e8)](),_0x4fb2d4=_0x31ca9a[_0x24ba33(0x2fe)]||[],_0xeae328=_0x31ca9a[_0x24ba33(0x26b)]||null,_0x4561b8=_0x31ca9a[_0x24ba33(0x234)]||{},_0x60e79b=_0x4fb2d4[_0x24ba33(0x196)](_0x7c1470=>{const _0xd2769b=_0x24ba33,_0x4016b6={..._0x7c1470};if(_0x7c1470[_0xd2769b(0x2cd)])try{_0x4016b6[_0xd2769b(0x28f)]=JSON[_0xd2769b(0x2f5)](_0x7c1470[_0xd2769b(0x2cd)]);}catch(_0x5aafef){_0x4016b6[_0xd2769b(0x28f)]=[];}else _0x4016b6['Tallas']=[];if(_0x7c1470[_0xd2769b(0x2c7)])try{_0x4016b6[_0xd2769b(0x1b8)]=JSON[_0xd2769b(0x2f5)](_0x7c1470[_0xd2769b(0x2c7)]);}catch(_0x113b23){_0x4016b6[_0xd2769b(0x1b8)]=[];}else _0x4016b6[_0xd2769b(0x1b8)]=[];return _0x4016b6[_0xd2769b(0x2af)]=_0x4016b6[_0xd2769b(0x28f)]&&_0x105f0c[_0xd2769b(0x2d6)](_0x4016b6[_0xd2769b(0x28f)]['length'],0x0),_0x4016b6[_0xd2769b(0x282)]=_0x4016b6[_0xd2769b(0x1b8)]&&_0x4016b6['Tamanos'][_0xd2769b(0x2e0)]>0x0,_0x4016b6['tieneTallas']&&(_0x4016b6[_0xd2769b(0x183)]=_0x4016b6[_0xd2769b(0x28f)][_0xd2769b(0x196)](_0x4bb4e0=>(_0x4bb4e0[_0xd2769b(0x226)]||_0x4bb4e0['Cantidad']||0x0)+_0xd2769b(0x255)+(_0x4bb4e0['talla']||_0x4bb4e0[_0xd2769b(0x1b3)]||_0x4bb4e0[_0xd2769b(0x1db)]||_0xd2769b(0x19f)))[_0xd2769b(0x256)](',\x20')),_0x4016b6['tieneTamanos']&&(_0x4016b6['descripcionTamanos']=_0x4016b6['Tamanos']['map'](_0x3fcc08=>_0x3fcc08[_0xd2769b(0x1f7)]+_0xd2769b(0x18e)+_0x3fcc08[_0xd2769b(0x1db)])['join'](',\x20')),_0x4016b6;}),_0x1f4b99=_0x60e79b['reduce']((_0x1ad0f2,_0x5d8769)=>_0x1ad0f2+Number(_0x5d8769[_0x24ba33(0x1ca)]||0x0),0x0),_0x18c3f8=_0xeae328?_0x105f0c[_0x24ba33(0x184)](Number,_0xeae328['Subtotal']||0x0):0x0,_0x1fcaa8=_0x105f0c[_0x24ba33(0x297)](_0x1f4b99,_0x18c3f8),_0x41494f=_0x105f0c[_0x24ba33(0x244)](_0x105f0c['Aetrc'](Number,_0x31ca9a[_0x24ba33(0x1d3)]),_0x1fcaa8);_0x43f765['json']({'status':_0x105f0c[_0x24ba33(0x29e)],'data':{'Id_Ventas':_0x31ca9a[_0x24ba33(0x2c4)],'Id_Agendamientos':_0x31ca9a[_0x24ba33(0x23d)],'Id_Cliente':_0x31ca9a[_0x24ba33(0x207)],'Id_Empleados':_0x31ca9a[_0x24ba33(0x1a7)],'Nombre_Empleado':_0x4561b8?.[_0x24ba33(0x228)]||'Desconocido','Fecha':_0x31ca9a[_0x24ba33(0x2db)],'Total':_0x31ca9a['Total'],'M_Pago':_0x31ca9a[_0x24ba33(0x26e)],'Referencia':_0x31ca9a[_0x24ba33(0x283)],'Estado':_0x31ca9a[_0x24ba33(0x1aa)],'Detalle_Venta':_0x60e79b,'tieneAgendamiento':!!_0x31ca9a[_0x24ba33(0x23d)],'Agendamiento':_0xeae328,'totalValidado':_0x41494f}});}catch(_0x1d20a1){console['error'](_0x105f0c[_0x24ba33(0x299)],_0x1d20a1),_0x43f765[_0x24ba33(0x1c7)](0x1f4)[_0x24ba33(0x206)]({'status':_0x105f0c['zckRm'],'message':_0x105f0c[_0x24ba33(0x222)]});}},exports['crearVenta']=async(_0x3b3a55,_0x368ef2)=>{const _0x6f1f55=a0_0x473939,_0x3b691d={'qLHHg':function(_0x881238,_0x3caf17){return _0x881238===_0x3caf17;},'DlGoa':_0x6f1f55(0x2a1),'YQngP':'Faltan\x20datos\x20requeridos','cKPIK':function(_0x36e232,_0x581f72,_0x477a17){return _0x36e232(_0x581f72,_0x477a17);},'mIOuh':function(_0x151f21,_0x35a1ba,_0x377834){return _0x151f21(_0x35a1ba,_0x377834);},'eFjhP':_0x6f1f55(0x2aa),'eWHBB':function(_0x5904fe,_0x2d521e){return _0x5904fe(_0x2d521e);},'sCCcc':'Nombre','dPOCP':_0x6f1f55(0x22f),'FmaEY':'string','CUqNN':function(_0x3209ab,_0x1dbb37){return _0x3209ab>_0x1dbb37;},'qnQpG':_0x6f1f55(0x292),'BBTnO':function(_0x3ece6b,_0x5c3760){return _0x3ece6b*_0x5c3760;},'tNwJY':function(_0x25268f,_0xfa4d0){return _0x25268f(_0xfa4d0);},'PxMdu':function(_0x315512,_0x46f107){return _0x315512(_0x46f107);},'sDFpX':_0x6f1f55(0x306),'skHKw':function(_0x260dac,_0x2ac360){return _0x260dac(_0x2ac360);},'iaokK':function(_0x4f9d62,_0x22b120){return _0x4f9d62<_0x22b120;},'uGJrn':function(_0xf2bcdd,_0x16a8f2){return _0xf2bcdd===_0x16a8f2;},'OoflY':function(_0x16d0cc,_0x18446c){return _0x16d0cc>_0x18446c;},'DFQiQ':function(_0x23e024,_0x2e29f2,_0x238fc5,_0x1bce1e,_0x593d4c,_0x2124b3){return _0x23e024(_0x2e29f2,_0x238fc5,_0x1bce1e,_0x593d4c,_0x2124b3);},'AHKFX':function(_0x56a647,_0x24cc91){return _0x56a647+_0x24cc91;},'WdgJw':function(_0x25358f,_0x45c7a0){return _0x25358f||_0x45c7a0;},'SvbhZ':function(_0x23a276,_0x67064d){return _0x23a276||_0x67064d;},'mDQRF':function(_0x585ccc,_0xa17db7){return _0x585ccc>_0xa17db7;},'EHnXM':function(_0x55134a,_0x42c244){return _0x55134a>_0x42c244;},'wNTBI':function(_0x4fe5a2,_0x547a96){return _0x4fe5a2>_0x547a96;},'iQBfm':function(_0x4455c5,_0x27ae84){return _0x4455c5>_0x27ae84;},'Jcjts':function(_0x1208d9,_0x3f0d66){return _0x1208d9>_0x3f0d66;},'jeTqM':function(_0x977821,_0x5f2b62,_0x4b44a3,_0x4cc5b1){return _0x977821(_0x5f2b62,_0x4b44a3,_0x4cc5b1);},'xNvKZ':'Venta\x20creada\x20correctamente','LIqIE':function(_0x4fd270,_0x3b34c7){return _0x4fd270 instanceof _0x3b34c7;},'Denwy':_0x6f1f55(0x23b),'rcpCH':_0x6f1f55(0x1a9),'OOFkY':_0x6f1f55(0x30a),'MrYyX':_0x6f1f55(0x1d4),'MviuZ':_0x6f1f55(0x28d),'izVVC':_0x6f1f55(0x25e),'EVZPX':_0x6f1f55(0x2c9)},_0x55e349=await sequelize[_0x6f1f55(0x2f7)]();try{const {Id_Agendamientos:_0x564a72,Id_Cliente:_0x2cf1a8,Id_Empleados:_0x4bcafd,Fecha:_0x136e69,M_Pago:_0x1503d8,Referencia:_0x37ae56,Estado:Estado=0x3,Detalle_Venta:_0x194f0d=[]}=_0x3b3a55['body'];if(!_0x2cf1a8||!_0x4bcafd||!_0x136e69||!_0x1503d8||_0x3b691d[_0x6f1f55(0x313)](_0x194f0d['length'],0x0))return await _0x55e349[_0x6f1f55(0x1da)](),_0x368ef2[_0x6f1f55(0x1c7)](0x190)[_0x6f1f55(0x206)]({'status':_0x3b691d['DlGoa'],'message':_0x3b691d[_0x6f1f55(0x1c2)],'required':{'Id_Cliente':_0x2cf1a8,'Id_Empleados':_0x4bcafd,'Fecha':_0x136e69,'M_Pago':_0x1503d8,'Detalles':_0x194f0d[_0x6f1f55(0x2e0)]}});await _0x3b691d[_0x6f1f55(0x2bf)](validarCliente,_0x2cf1a8,_0x55e349),await _0x3b691d[_0x6f1f55(0x236)](validarEmpleado,_0x4bcafd,_0x55e349),_0x3b691d[_0x6f1f55(0x2bf)](validarMetodoPago,_0x1503d8,_0x37ae56);let _0x878557=0x0;if(_0x564a72){const _0x595586=await Agendamientos[_0x6f1f55(0x277)](_0x564a72,{'transaction':_0x55e349});if(!_0x595586)return await _0x55e349[_0x6f1f55(0x1da)](),_0x368ef2[_0x6f1f55(0x1c7)](0x190)['json']({'status':_0x3b691d[_0x6f1f55(0x2b3)],'message':_0x3b691d[_0x6f1f55(0x1a8)]});_0x878557=_0x3b691d[_0x6f1f55(0x26c)](Number,_0x595586['Subtotal']||0x0);}let _0x35a6be=0x0;const _0xa8cd4=[];for(const _0x37500d of _0x194f0d){const _0x47cc62=await Productos[_0x6f1f55(0x277)](_0x37500d['Id_Productos'],{'transaction':_0x55e349,'attributes':[_0x6f1f55(0x1c4),_0x3b691d['sCCcc'],_0x3b691d[_0x6f1f55(0x281)]]});if(!_0x47cc62)return await _0x55e349['rollback'](),_0x368ef2[_0x6f1f55(0x1c7)](0x190)[_0x6f1f55(0x206)]({'status':_0x3b691d[_0x6f1f55(0x2b3)],'message':_0x6f1f55(0x19e)+_0x37500d[_0x6f1f55(0x1c4)]+_0x6f1f55(0x30b)});let _0x1b4cfd=_0x37500d['Tallas']||[],_0x3f28df=_0x37500d[_0x6f1f55(0x1b8)]||[];if(_0x37500d[_0x6f1f55(0x2c7)]&&_0x3b691d[_0x6f1f55(0x313)](typeof _0x37500d[_0x6f1f55(0x2c7)],'string'))try{_0x3f28df=JSON[_0x6f1f55(0x2f5)](_0x37500d['Tamanos_Data']);}catch(_0x1be57c){_0x3f28df=[];}else _0x37500d[_0x6f1f55(0x2c7)]&&Array[_0x6f1f55(0x1f1)](_0x37500d['Tamanos_Data'])&&(_0x3f28df=_0x37500d[_0x6f1f55(0x2c7)]);if(_0x37500d[_0x6f1f55(0x2cd)]&&_0x3b691d[_0x6f1f55(0x313)](typeof _0x37500d['Tallas_Data'],_0x3b691d[_0x6f1f55(0x2d0)]))try{_0x1b4cfd=JSON[_0x6f1f55(0x2f5)](_0x37500d[_0x6f1f55(0x2cd)]);}catch(_0x22e213){_0x1b4cfd=[];}else _0x37500d[_0x6f1f55(0x2cd)]&&Array['isArray'](_0x37500d[_0x6f1f55(0x2cd)])&&(_0x1b4cfd=_0x37500d[_0x6f1f55(0x2cd)]);try{if(_0x3f28df&&_0x3b691d[_0x6f1f55(0x2df)](_0x3f28df[_0x6f1f55(0x2e0)],0x0))for(const _0x287d7e of _0x3f28df){const _0x5e1793=_0x287d7e[_0x6f1f55(0x1db)]||_0x287d7e[_0x6f1f55(0x228)]||'';if(!_0x5e1793)return await _0x55e349['rollback'](),_0x368ef2[_0x6f1f55(0x1c7)](0x190)['json']({'status':_0x3b691d['DlGoa'],'message':_0x6f1f55(0x188)+_0x47cc62[_0x6f1f55(0x228)]});const _0x391ee2=await Tamano['findOne']({'where':{'Nombre':_0x5e1793},'transaction':_0x55e349});if(!_0x391ee2)return await _0x55e349[_0x6f1f55(0x1da)](),_0x368ef2[_0x6f1f55(0x1c7)](0x190)[_0x6f1f55(0x206)]({'status':_0x3b691d[_0x6f1f55(0x2b3)],'message':_0x6f1f55(0x2dc)+_0x5e1793+_0x6f1f55(0x30b)});const _0x216b5c=await Producto_Tamano[_0x6f1f55(0x1fa)]({'where':{'Id_Productos':_0x37500d['Id_Productos'],'Id_Tamano':_0x391ee2['Id_Tamano']},'transaction':_0x55e349});if(!_0x216b5c)return await _0x55e349[_0x6f1f55(0x1da)](),_0x368ef2['status'](0x190)[_0x6f1f55(0x206)]({'status':_0x3b691d[_0x6f1f55(0x2b3)],'message':_0x6f1f55(0x18d)+_0x47cc62[_0x6f1f55(0x228)]+_0x6f1f55(0x231)+_0x5e1793+_0x6f1f55(0x2f8)});const _0x45b0d3=await Producto_Tamano_Insumos['findAll']({'where':{'Id_Producto_Tamano':_0x216b5c[_0x6f1f55(0x2d5)]},'include':[{'model':Insumos,'as':_0x3b691d['qnQpG']}],'transaction':_0x55e349}),_0xbf48b7=await Tamano_Insumos[_0x6f1f55(0x216)]({'where':{'Id_Tamano':_0x391ee2[_0x6f1f55(0x224)]},'include':[{'model':Insumos,'as':_0x3b691d['qnQpG']}],'transaction':_0x55e349}),_0x4ad5bb=Number(_0x287d7e['Cantidad']||_0x287d7e['cantidad']||0x0),_0x5ae372=new Map();for(const _0x3cd77b of _0x45b0d3){const _0x24d4d1=_0x3cd77b['Id_Insumos_Insumo'],_0x21b95c=Number(_0x3cd77b[_0x6f1f55(0x1b5)]||0x0),_0x2050e5=_0x3b691d[_0x6f1f55(0x242)](_0x21b95c,_0x4ad5bb),_0x4f4351=Number(_0x24d4d1[_0x6f1f55(0x25d)]||0x0);if(_0x4f4351<_0x2050e5)return await _0x55e349['rollback'](),_0x368ef2[_0x6f1f55(0x1c7)](0x190)[_0x6f1f55(0x206)]({'status':'error','message':_0x6f1f55(0x278)+_0x24d4d1['Nombre']+_0x6f1f55(0x25f)+_0x4f4351+',\x20Necesario:\x20'+_0x2050e5});_0x5ae372[_0x6f1f55(0x19a)](_0x24d4d1['Id_Insumos'],!![]);}for(const _0x5c61d0 of _0xbf48b7){const _0x8ebffc=_0x5c61d0[_0x6f1f55(0x292)];if(_0x5ae372[_0x6f1f55(0x272)](_0x8ebffc[_0x6f1f55(0x22b)]))continue;const _0x3bc5e5=Number(_0x5c61d0[_0x6f1f55(0x1f7)]||0x0),_0x5bd2ae=_0x3b691d['BBTnO'](_0x3bc5e5,_0x4ad5bb),_0x432027=_0x3b691d[_0x6f1f55(0x1d5)](Number,_0x8ebffc['Stock']||0x0);if(_0x432027<_0x5bd2ae)return await _0x55e349['rollback'](),_0x368ef2[_0x6f1f55(0x1c7)](0x190)['json']({'status':_0x3b691d[_0x6f1f55(0x2b3)],'message':_0x6f1f55(0x2b8)+_0x8ebffc[_0x6f1f55(0x228)]+_0x6f1f55(0x25f)+_0x432027+',\x20Necesario:\x20'+_0x5bd2ae});}}else{if(_0x1b4cfd&&_0x3b691d[_0x6f1f55(0x2df)](_0x1b4cfd[_0x6f1f55(0x2e0)],0x0))for(const _0x5d1eea of _0x1b4cfd){const _0x3e5de5=_0x5d1eea[_0x6f1f55(0x2dd)]||_0x5d1eea[_0x6f1f55(0x1b3)]||_0x5d1eea[_0x6f1f55(0x1db)]||'',_0x10fbea=_0x3b691d[_0x6f1f55(0x27e)](Number,_0x5d1eea['cantidad']||_0x5d1eea['Cantidad']||0x0);if(!_0x3e5de5)return await _0x55e349[_0x6f1f55(0x1da)](),_0x368ef2[_0x6f1f55(0x1c7)](0x190)['json']({'status':_0x3b691d[_0x6f1f55(0x2b3)],'message':_0x6f1f55(0x199)+_0x47cc62[_0x6f1f55(0x228)]});const _0x1eea15=await Tallas[_0x6f1f55(0x1fa)]({'where':{'Nombre':_0x3e5de5},'transaction':_0x55e349});if(!_0x1eea15)return await _0x55e349[_0x6f1f55(0x1da)](),_0x368ef2[_0x6f1f55(0x1c7)](0x190)[_0x6f1f55(0x206)]({'status':_0x3b691d[_0x6f1f55(0x2b3)],'message':_0x6f1f55(0x1f4)+_0x3e5de5+_0x6f1f55(0x2a4)});const _0xf2c8a0=await Producto_Tallas[_0x6f1f55(0x1fa)]({'where':{'Id_Productos':_0x37500d[_0x6f1f55(0x1c4)],'Id_Tallas':_0x1eea15[_0x6f1f55(0x2e1)]},'transaction':_0x55e349});if(!_0xf2c8a0)return await _0x55e349[_0x6f1f55(0x1da)](),_0x368ef2[_0x6f1f55(0x1c7)](0x190)[_0x6f1f55(0x206)]({'status':_0x3b691d[_0x6f1f55(0x2b3)],'message':'Talla\x20'+_0x3e5de5+_0x6f1f55(0x2ef)+_0x47cc62['Nombre']});const _0x32992f=Number(_0xf2c8a0[_0x6f1f55(0x25d)]||0x0);if(_0x32992f<_0x10fbea)return await _0x55e349[_0x6f1f55(0x1da)](),_0x368ef2[_0x6f1f55(0x1c7)](0x190)[_0x6f1f55(0x206)]({'status':_0x3b691d[_0x6f1f55(0x2b3)],'message':'Stock\x20insuficiente\x20para\x20talla\x20'+_0x3e5de5+_0x6f1f55(0x1a5)+_0x47cc62['Nombre']+_0x6f1f55(0x25f)+_0x32992f+_0x6f1f55(0x1bb)+_0x10fbea});}else{const _0x35a2e4=await Producto_Tallas[_0x6f1f55(0x216)]({'where':{'Id_Productos':_0x37500d[_0x6f1f55(0x1c4)]},'include':[{'model':Tallas,'as':_0x3b691d[_0x6f1f55(0x2a5)],'attributes':[_0x6f1f55(0x2e1),_0x3b691d['sCCcc']]}],'transaction':_0x55e349});if(_0x35a2e4&&_0x3b691d['CUqNN'](_0x35a2e4[_0x6f1f55(0x2e0)],0x0))return await _0x55e349['rollback'](),_0x368ef2[_0x6f1f55(0x1c7)](0x190)['json']({'status':_0x3b691d[_0x6f1f55(0x2b3)],'message':'El\x20producto\x20'+_0x47cc62[_0x6f1f55(0x228)]+_0x6f1f55(0x2b1)+_0x35a2e4[_0x6f1f55(0x196)](_0x362402=>_0x362402[_0x6f1f55(0x306)]?.['Nombre']||'N/A')['join'](',\x20')});const _0x119e46=_0x3b691d['skHKw'](Number,_0x47cc62['Stock']||0x0),_0x5f0e29=Number(_0x37500d[_0x6f1f55(0x1f7)]||0x0);if(_0x3b691d[_0x6f1f55(0x28a)](_0x119e46,_0x5f0e29))return await _0x55e349['rollback'](),_0x368ef2['status'](0x190)[_0x6f1f55(0x206)]({'status':_0x3b691d[_0x6f1f55(0x2b3)],'message':_0x6f1f55(0x2c0)+_0x47cc62['Nombre']+_0x6f1f55(0x25f)+_0x119e46+_0x6f1f55(0x1bb)+_0x5f0e29});}}}catch(_0x29bed1){return await _0x55e349[_0x6f1f55(0x1da)](),_0x368ef2[_0x6f1f55(0x1c7)](0x190)[_0x6f1f55(0x206)]({'status':_0x3b691d[_0x6f1f55(0x2b3)],'message':_0x6f1f55(0x275)+_0x29bed1[_0x6f1f55(0x1b0)]});}if(_0x37500d['Tamanos_Data']&&typeof _0x37500d['Tamanos_Data']===_0x3b691d[_0x6f1f55(0x2d0)])try{_0x3f28df=JSON[_0x6f1f55(0x2f5)](_0x37500d[_0x6f1f55(0x2c7)]);}catch(_0x1d1c09){_0x3f28df=[];}else _0x37500d[_0x6f1f55(0x2c7)]&&Array[_0x6f1f55(0x1f1)](_0x37500d[_0x6f1f55(0x2c7)])&&(_0x3f28df=_0x37500d[_0x6f1f55(0x2c7)]);if(_0x37500d['Tallas_Data']&&_0x3b691d[_0x6f1f55(0x1e4)](typeof _0x37500d[_0x6f1f55(0x2cd)],_0x6f1f55(0x2e4)))try{_0x1b4cfd=JSON[_0x6f1f55(0x2f5)](_0x37500d[_0x6f1f55(0x2cd)]);}catch(_0x59ef04){_0x1b4cfd=[];}else _0x37500d[_0x6f1f55(0x2cd)]&&Array[_0x6f1f55(0x1f1)](_0x37500d[_0x6f1f55(0x2cd)])&&(_0x1b4cfd=_0x37500d[_0x6f1f55(0x2cd)]);_0x1b4cfd&&_0x3b691d[_0x6f1f55(0x220)](_0x1b4cfd[_0x6f1f55(0x2e0)],0x0)&&(_0x1b4cfd=_0x1b4cfd[_0x6f1f55(0x196)](_0x429c44=>{const _0x46a367=_0x6f1f55;if(typeof _0x429c44==='string')return{'talla':_0x429c44,'cantidad':0x1,'precio':0x0};return{'talla':_0x429c44[_0x46a367(0x2dd)]||_0x429c44['Talla']||_0x429c44[_0x46a367(0x1db)]||'','cantidad':_0x429c44['cantidad']||_0x429c44[_0x46a367(0x1f7)]||0x1,'precio':_0x429c44[_0x46a367(0x2be)]||_0x429c44[_0x46a367(0x304)]||0x0,'Id_Producto_Tallas':_0x429c44[_0x46a367(0x249)]||null};})[_0x6f1f55(0x260)](_0x271408=>_0x271408[_0x6f1f55(0x2dd)]&&_0x271408[_0x6f1f55(0x2dd)]['trim']()!==''));const _0x347626=await _0x3b691d[_0x6f1f55(0x18f)](calcularPrecio,_0x47cc62,_0x1b4cfd,_0x3f28df,_0x37500d[_0x6f1f55(0x1f7)],_0x55e349),_0x636f36=_0x347626;_0xa8cd4[_0x6f1f55(0x2d3)]({..._0x37500d,'Precio':_0x347626,'Subtotal':_0x636f36,'Tallas':_0x1b4cfd,'Tamanos':_0x3f28df,'Tallas_Original':_0x37500d[_0x6f1f55(0x28f)]||[],'Tamanos_Original':_0x37500d[_0x6f1f55(0x1b8)]||[],'Tallas_Data_Original':_0x37500d[_0x6f1f55(0x2cd)],'Tamanos_Data_Original':_0x37500d['Tamanos_Data']}),_0x35a6be+=_0x636f36;}const _0x1f724e=_0x3b691d[_0x6f1f55(0x301)](_0x35a6be,_0x878557),_0x5bc6a6=await Ventas[_0x6f1f55(0x243)]({'Id_Agendamientos':_0x3b691d['WdgJw'](_0x564a72,null),'Id_Cliente':_0x2cf1a8,'Id_Empleados':_0x4bcafd,'Fecha':_0x136e69,'Total':_0x1f724e,'Estado':Estado,'M_Pago':_0x1503d8,'Referencia':_0x3b691d['SvbhZ'](_0x37ae56,null)},{'transaction':_0x55e349});for(const _0x121232 of _0xa8cd4){let _0x520225=[],_0x2250de=[];if(_0x121232[_0x6f1f55(0x271)]&&_0x3b691d[_0x6f1f55(0x1e4)](typeof _0x121232[_0x6f1f55(0x271)],_0x6f1f55(0x2e4)))try{_0x520225=JSON[_0x6f1f55(0x2f5)](_0x121232[_0x6f1f55(0x271)]);}catch(_0x1acca1){_0x520225=_0x121232[_0x6f1f55(0x2ee)]||[];}else _0x121232[_0x6f1f55(0x2ee)]&&_0x3b691d[_0x6f1f55(0x270)](_0x121232['Tallas_Original'][_0x6f1f55(0x2e0)],0x0)?_0x520225=_0x121232[_0x6f1f55(0x2ee)]:_0x520225=_0x121232[_0x6f1f55(0x28f)]||[];if(_0x121232['Tamanos_Data_Original']&&_0x3b691d['qLHHg'](typeof _0x121232[_0x6f1f55(0x241)],_0x3b691d[_0x6f1f55(0x2d0)]))try{_0x2250de=JSON[_0x6f1f55(0x2f5)](_0x121232[_0x6f1f55(0x241)]);}catch(_0x360d6f){_0x2250de=_0x121232[_0x6f1f55(0x250)]||[];}else _0x121232[_0x6f1f55(0x250)]&&_0x3b691d['OoflY'](_0x121232[_0x6f1f55(0x250)][_0x6f1f55(0x2e0)],0x0)?_0x2250de=_0x121232[_0x6f1f55(0x250)]:_0x2250de=_0x121232[_0x6f1f55(0x1b8)]||[];_0x2250de&&_0x3b691d[_0x6f1f55(0x22c)](_0x2250de[_0x6f1f55(0x2e0)],0x0)&&(_0x2250de=_0x2250de[_0x6f1f55(0x196)](_0x146fed=>({..._0x146fed,'PrecioTotal':Number(_0x146fed['PrecioTotal']||0x0)})));_0x520225&&_0x3b691d['OoflY'](_0x520225[_0x6f1f55(0x2e0)],0x0)&&(_0x520225=_0x520225[_0x6f1f55(0x196)](_0x2b3ede=>{const _0x32b5d7=_0x6f1f55,_0x3d45b3={..._0x2b3ede,'talla':_0x2b3ede[_0x32b5d7(0x2dd)]||_0x2b3ede[_0x32b5d7(0x1b3)]||_0x2b3ede[_0x32b5d7(0x1db)]||'','cantidad':_0x2b3ede[_0x32b5d7(0x226)]||_0x2b3ede[_0x32b5d7(0x1f7)]||0x0,'precio':_0x2b3ede[_0x32b5d7(0x2be)]||_0x2b3ede[_0x32b5d7(0x304)]||0x0,'descripcion':_0x2b3ede[_0x32b5d7(0x1bf)]||(_0x2b3ede[_0x32b5d7(0x226)]||_0x2b3ede[_0x32b5d7(0x1f7)]||0x0)+_0x32b5d7(0x255)+(_0x2b3ede[_0x32b5d7(0x2dd)]||_0x2b3ede[_0x32b5d7(0x1b3)]||_0x2b3ede[_0x32b5d7(0x1db)]||''),'detalleTalla':_0x2b3ede[_0x32b5d7(0x213)]||'Talla\x20'+(_0x2b3ede[_0x32b5d7(0x2dd)]||_0x2b3ede[_0x32b5d7(0x1b3)]||_0x2b3ede[_0x32b5d7(0x1db)]||'')+':\x20'+(_0x2b3ede['cantidad']||_0x2b3ede[_0x32b5d7(0x1f7)]||0x0)+_0x32b5d7(0x1cc)};return delete _0x3d45b3['Cantidad'],delete _0x3d45b3[_0x32b5d7(0x1b3)],delete _0x3d45b3['Precio'],_0x3d45b3;})['filter'](_0x2e6953=>_0x2e6953[_0x6f1f55(0x2dd)]&&_0x2e6953['talla'][_0x6f1f55(0x1de)]()!==''));const _0x25c8e5=_0x520225&&_0x3b691d[_0x6f1f55(0x1a2)](_0x520225[_0x6f1f55(0x2e0)],0x0)?JSON[_0x6f1f55(0x26f)](_0x520225):null,_0x3220fa=_0x2250de&&_0x2250de[_0x6f1f55(0x2e0)]>0x0?JSON['stringify'](_0x2250de):null,_0x4d804e={'Id_Ventas':_0x5bc6a6[_0x6f1f55(0x2c4)],'Id_Productos':_0x121232[_0x6f1f55(0x1c4)]||null,'Id_Servicios':_0x121232[_0x6f1f55(0x2da)]||null,'Id_Producto_Tallas':_0x3b691d[_0x6f1f55(0x2b7)](_0x520225[_0x6f1f55(0x2e0)],0x0)?_0x520225[0x0][_0x6f1f55(0x249)]:null,'Id_Producto_Tamano_Insumos':_0x3b691d[_0x6f1f55(0x17f)](_0x2250de[_0x6f1f55(0x2e0)],0x0)?_0x2250de[0x0][_0x6f1f55(0x1a3)]:null,'Cantidad':_0x121232[_0x6f1f55(0x1f7)],'Precio':_0x121232[_0x6f1f55(0x304)],'Subtotal':_0x121232[_0x6f1f55(0x1ca)]};if(_0x25c8e5)_0x4d804e['Tallas_Data']=_0x25c8e5;if(_0x3220fa)_0x4d804e['Tamanos_Data']=_0x3220fa;const _0x41a6da=await Detalle_Venta[_0x6f1f55(0x243)](_0x4d804e,{'transaction':_0x55e349});}for(const _0x1e1254 of _0xa8cd4){const _0xdd8c6e=_0x1e1254[_0x6f1f55(0x28f)]||[],_0x128b2f=_0x1e1254[_0x6f1f55(0x1b8)]||[];try{if(_0x128b2f&&_0x3b691d[_0x6f1f55(0x2b7)](_0x128b2f[_0x6f1f55(0x2e0)],0x0))await actualizarStockInsumos(_0x1e1254[_0x6f1f55(0x1c4)],_0x128b2f,_0x55e349);else _0xdd8c6e&&_0x3b691d[_0x6f1f55(0x270)](_0xdd8c6e[_0x6f1f55(0x2e0)],0x0)?await _0x3b691d[_0x6f1f55(0x1b2)](actualizarStockTallas,_0x1e1254[_0x6f1f55(0x1c4)],_0xdd8c6e,_0x55e349):await _0x3b691d['jeTqM'](actualizarStockProducto,_0x1e1254[_0x6f1f55(0x1c4)],_0x1e1254[_0x6f1f55(0x1f7)],_0x55e349);}catch(_0x123efe){return await _0x55e349['rollback'](),_0x368ef2[_0x6f1f55(0x1c7)](0x190)[_0x6f1f55(0x206)]({'status':_0x3b691d[_0x6f1f55(0x2b3)],'message':_0x6f1f55(0x229)+_0x123efe[_0x6f1f55(0x1b0)]});}}await _0x55e349['commit'](),_0x368ef2[_0x6f1f55(0x1c7)](0xc9)[_0x6f1f55(0x206)]({'status':_0x6f1f55(0x21f),'message':_0x3b691d[_0x6f1f55(0x1bd)],'data':{'Id_Ventas':_0x5bc6a6[_0x6f1f55(0x2c4)],'Total':_0x1f724e,'totalValidado':!![],'Detalle_Venta':_0xa8cd4}});}catch(_0x5e735b){const _0x2aefdd=_0x6f1f55(0x1f5)[_0x6f1f55(0x2e9)]('|');let _0x4cfc49=0x0;while(!![]){switch(_0x2aefdd[_0x4cfc49++]){case'0':if(_0x3b691d[_0x6f1f55(0x288)](_0x5e735b,ValidationError))return _0x368ef2[_0x6f1f55(0x1c7)](0x190)['json']({'status':_0x3b691d[_0x6f1f55(0x2b3)],'message':_0x6f1f55(0x1f0),'detail':_0x5e735b['errors']['map'](_0x36353e=>_0x36353e['message'])});continue;case'1':if(_0x5e735b instanceof DatabaseError)return _0x368ef2['status'](0x1f4)[_0x6f1f55(0x206)]({'status':_0x3b691d[_0x6f1f55(0x2b3)],'message':_0x6f1f55(0x1fe),'detail':_0x5e735b[_0x6f1f55(0x1b0)]});continue;case'2':return _0x368ef2['status'](0x1f4)['json']({'status':_0x3b691d[_0x6f1f55(0x2b3)],'message':_0x3b691d[_0x6f1f55(0x217)],'detail':_0x5e735b['message']});case'3':if(_0x5e735b instanceof UniqueConstraintError)return _0x368ef2[_0x6f1f55(0x1c7)](0x199)[_0x6f1f55(0x206)]({'status':_0x3b691d[_0x6f1f55(0x2b3)],'message':_0x3b691d['rcpCH'],'detail':_0x3b691d[_0x6f1f55(0x25a)]});continue;case'4':console[_0x6f1f55(0x2a1)](_0x6f1f55(0x1ea),_0x5e735b);continue;case'5':await _0x55e349[_0x6f1f55(0x1da)]();continue;case'6':if(_0x5e735b[_0x6f1f55(0x1b0)]['includes'](_0x3b691d[_0x6f1f55(0x2a3)])||_0x5e735b[_0x6f1f55(0x1b0)]['includes'](_0x3b691d[_0x6f1f55(0x1f8)])||_0x5e735b['message'][_0x6f1f55(0x248)](_0x3b691d[_0x6f1f55(0x2ca)])||_0x5e735b[_0x6f1f55(0x1b0)][_0x6f1f55(0x248)](_0x3b691d['EVZPX']))return _0x368ef2[_0x6f1f55(0x1c7)](0x190)[_0x6f1f55(0x206)]({'status':_0x3b691d['DlGoa'],'message':_0x5e735b[_0x6f1f55(0x1b0)]});continue;}break;}}},exports[a0_0x473939(0x1d6)]=async(_0x21f4d8,_0x163aa9)=>{const _0x23a9f9=a0_0x473939,_0x1b6cfa={'aHgHb':_0x23a9f9(0x2fe),'CIouw':_0x23a9f9(0x2a1),'QCKwi':'Venta\x20no\x20encontrada','wRvvt':_0x23a9f9(0x311),'sIYDW':_0x23a9f9(0x21f),'Jyqqr':_0x23a9f9(0x2ec),'DGORJ':_0x23a9f9(0x2b5),'ScvyP':function(_0xea6aff,_0x48cfaf){return _0xea6aff===_0x48cfaf;},'VpMLJ':_0x23a9f9(0x2bc)},_0x4c96eb=await sequelize['transaction']();try{const {id:_0x510b4b}=_0x21f4d8[_0x23a9f9(0x2ce)],_0x3ddc4c=await Ventas[_0x23a9f9(0x277)](_0x510b4b,{'include':[{'model':Detalle_Venta,'as':_0x1b6cfa['aHgHb']}],'transaction':_0x4c96eb});if(!_0x3ddc4c)return await _0x4c96eb['rollback'](),_0x163aa9['status'](0x194)[_0x23a9f9(0x206)]({'status':_0x1b6cfa[_0x23a9f9(0x1c5)],'message':_0x1b6cfa['QCKwi']});if(_0x3ddc4c[_0x23a9f9(0x1aa)]!==0x3)return await _0x4c96eb[_0x23a9f9(0x1da)](),_0x163aa9[_0x23a9f9(0x1c7)](0x190)[_0x23a9f9(0x206)]({'status':_0x1b6cfa[_0x23a9f9(0x1c5)],'message':_0x1b6cfa['wRvvt']});await _0x3ddc4c[_0x23a9f9(0x18c)]({'Estado':0x1,'Fecha_Completado':new Date()},{'transaction':_0x4c96eb}),await _0x4c96eb[_0x23a9f9(0x305)](),_0x163aa9[_0x23a9f9(0x206)]({'status':_0x1b6cfa[_0x23a9f9(0x1a4)],'message':_0x23a9f9(0x1fc),'data':{'Id_Ventas':_0x3ddc4c[_0x23a9f9(0x2c4)],'Estado':_0x3ddc4c[_0x23a9f9(0x1aa)],'EstadoDescripcion':_0x1b6cfa[_0x23a9f9(0x1d0)],'Fecha_Completado':_0x3ddc4c[_0x23a9f9(0x20d)]}});}catch(_0x6d5876){await _0x4c96eb['rollback'](),console[_0x23a9f9(0x2a1)](_0x1b6cfa[_0x23a9f9(0x29a)],_0x6d5876),_0x163aa9[_0x23a9f9(0x1c7)](0x1f4)[_0x23a9f9(0x206)]({'status':_0x1b6cfa[_0x23a9f9(0x1c5)],'message':_0x1b6cfa[_0x23a9f9(0x30e)](process[_0x23a9f9(0x2b9)][_0x23a9f9(0x2bd)],_0x23a9f9(0x189))?'Error\x20al\x20marcar\x20venta\x20como\x20completada:\x20'+_0x6d5876[_0x23a9f9(0x1b0)]:_0x1b6cfa[_0x23a9f9(0x1f6)]});}},exports[a0_0x473939(0x1b9)]=async(_0x1628e0,_0x9f6a32)=>{const _0x50650e=a0_0x473939,_0xf2ca86={'aGysB':'Detalle_Venta','yIQXx':_0x50650e(0x2a1),'wENXj':function(_0x2125ca,_0x3a8a92){return _0x2125ca!==_0x3a8a92;},'Uisfw':_0x50650e(0x1d8),'ILEHq':_0x50650e(0x21f),'HKlDZ':_0x50650e(0x21c),'PxIfe':_0x50650e(0x1e1)},_0x8a055e=await sequelize[_0x50650e(0x2f7)]();try{const {id:_0x5163d3}=_0x1628e0[_0x50650e(0x2ce)],_0x333415=await Ventas[_0x50650e(0x277)](_0x5163d3,{'include':[{'model':Detalle_Venta,'as':_0xf2ca86[_0x50650e(0x254)]}],'transaction':_0x8a055e});if(!_0x333415)return await _0x8a055e[_0x50650e(0x1da)](),_0x9f6a32[_0x50650e(0x1c7)](0x194)[_0x50650e(0x206)]({'status':_0xf2ca86[_0x50650e(0x19b)],'message':_0x50650e(0x23a)});if(_0xf2ca86[_0x50650e(0x300)](_0x333415[_0x50650e(0x1aa)],0x3))return await _0x8a055e[_0x50650e(0x1da)](),_0x9f6a32[_0x50650e(0x1c7)](0x190)[_0x50650e(0x206)]({'status':_0xf2ca86[_0x50650e(0x19b)],'message':_0xf2ca86[_0x50650e(0x1ba)]});await _0x333415[_0x50650e(0x18c)]({'Estado':0x2,'Fecha_Anulacion':new Date()},{'transaction':_0x8a055e}),await _0x8a055e['commit'](),_0x9f6a32['json']({'status':_0xf2ca86[_0x50650e(0x237)],'message':_0xf2ca86['HKlDZ'],'data':{'Id_Ventas':_0x333415[_0x50650e(0x2c4)],'Estado':_0x333415[_0x50650e(0x1aa)],'EstadoDescripcion':_0xf2ca86[_0x50650e(0x24b)],'Fecha_Anulacion':_0x333415[_0x50650e(0x197)]}});}catch(_0x1786e8){await _0x8a055e[_0x50650e(0x1da)](),console['error'](_0x50650e(0x186),_0x1786e8),_0x9f6a32[_0x50650e(0x1c7)](0x1f4)[_0x50650e(0x206)]({'status':_0xf2ca86[_0x50650e(0x19b)],'message':process[_0x50650e(0x2b9)][_0x50650e(0x2bd)]===_0x50650e(0x189)?_0x50650e(0x30f)+_0x1786e8[_0x50650e(0x1b0)]:_0x50650e(0x1ad)});}},exports[a0_0x473939(0x209)]=async(_0x40e2ed,_0x4f1d26)=>{const _0x8f4e69=a0_0x473939,_0x158f72={'WneEr':'error','Zfzcv':_0x8f4e69(0x2b4),'vnnpe':_0x8f4e69(0x1c1),'qHgVy':function(_0x2320f7,_0x219102){return _0x2320f7>_0x219102;},'Tobvy':function(_0x540663,_0x148ca5){return _0x540663(_0x148ca5);},'xeptM':'Error\x20al\x20validar\x20stock:','AAiiI':_0x8f4e69(0x1f9)};try{const {Id_Productos:_0x13dc5e,Cantidad:_0x4ed39b,Tallas:_0xf4a5b7,Tamanos:_0xd7df90}=_0x40e2ed[_0x8f4e69(0x1b1)];if(!_0x13dc5e)return _0x4f1d26[_0x8f4e69(0x1c7)](0x190)[_0x8f4e69(0x206)]({'status':_0x158f72['WneEr'],'message':_0x158f72[_0x8f4e69(0x2fd)]});const _0x139dcf=await Productos['findByPk'](_0x13dc5e);if(!_0x139dcf)return _0x4f1d26[_0x8f4e69(0x1c7)](0x194)[_0x8f4e69(0x206)]({'status':'error','message':_0x158f72[_0x8f4e69(0x20b)]});let _0x53382e=!![],_0x488755=[];if(_0xf4a5b7&&_0x158f72[_0x8f4e69(0x212)](_0xf4a5b7[_0x8f4e69(0x2e0)],0x0))for(const _0x4d0881 of _0xf4a5b7){const _0x518353=_0x4d0881[_0x8f4e69(0x2dd)]||_0x4d0881[_0x8f4e69(0x1b3)]||_0x4d0881[_0x8f4e69(0x1db)]||'',_0x1a7415=_0x158f72[_0x8f4e69(0x2eb)](Number,_0x4d0881[_0x8f4e69(0x226)]||_0x4d0881[_0x8f4e69(0x1f7)]||0x0);if(!_0x518353){_0x53382e=![],_0x488755[_0x8f4e69(0x2d3)](_0x8f4e69(0x199)+_0x139dcf[_0x8f4e69(0x228)]);continue;}const _0x22672d=await _0xf4a5b7[_0x8f4e69(0x1fa)]({'where':{'Nombre':_0x518353}});if(!_0x22672d){_0x53382e=![],_0x488755[_0x8f4e69(0x2d3)](_0x8f4e69(0x1f4)+_0x518353+_0x8f4e69(0x2a4));continue;}const _0x4b1552=await Producto_Tallas['findOne']({'where':{'Id_Productos':_0x139dcf['Id_Productos'],'Id_Tallas':_0x22672d[_0x8f4e69(0x2e1)]}});(!_0x4b1552||_0x4b1552['Stock']<_0x1a7415)&&(_0x53382e=![],_0x488755[_0x8f4e69(0x2d3)](_0x8f4e69(0x201)+_0x518353+_0x8f4e69(0x2a6)+(_0x4b1552?.['Stock']||0x0)+_0x8f4e69(0x18a)+_0x1a7415));}if(_0xd7df90&&_0x158f72[_0x8f4e69(0x212)](_0xd7df90[_0x8f4e69(0x2e0)],0x0))for(const _0x79b46e of _0xd7df90){const _0x1b9808=_0x79b46e[_0x8f4e69(0x1db)]||_0x79b46e[_0x8f4e69(0x228)]||'';if(!_0x1b9808){_0x53382e=![],_0x488755[_0x8f4e69(0x2d3)](_0x8f4e69(0x188)+_0x139dcf[_0x8f4e69(0x228)]);continue;}const _0x503d8f=await Tamano['findOne']({'where':{'Nombre':_0x1b9808}});if(!_0x503d8f){_0x53382e=![],_0x488755[_0x8f4e69(0x2d3)](_0x8f4e69(0x2dc)+_0x1b9808+_0x8f4e69(0x30b));continue;}const _0xe87a80=await Producto_Tamano['findOne']({'where':{'Id_Productos':_0x139dcf['Id_Productos'],'Id_Tamano':_0x503d8f['Id_Tamano']}});!_0xe87a80&&(_0x53382e=![],_0x488755[_0x8f4e69(0x2d3)](_0x8f4e69(0x18d)+_0x139dcf['Nombre']+'\x20no\x20tiene\x20el\x20tamaño\x20'+_0x1b9808+_0x8f4e69(0x2f8)));}_0x4f1d26['json']({'status':'success','data':{'Id_Productos':_0x139dcf[_0x8f4e69(0x1c4)],'Nombre':_0x139dcf[_0x8f4e69(0x228)],'stockDisponible':_0x53382e,'mensajes':_0x488755}});}catch(_0x2bf3f6){console[_0x8f4e69(0x2a1)](_0x158f72[_0x8f4e69(0x24c)],_0x2bf3f6),_0x4f1d26[_0x8f4e69(0x1c7)](0x1f4)[_0x8f4e69(0x206)]({'status':_0x8f4e69(0x2a1),'message':_0x158f72['AAiiI']});}},exports[a0_0x473939(0x1ae)]=async(_0x1175db,_0x2c399c)=>{const _0xd4b8b0=a0_0x473939,_0x52a784={'MINTD':_0xd4b8b0(0x2f0),'zpaDX':function(_0x53238d,_0x4ceef7){return _0x53238d(_0x4ceef7);},'jsrdk':'Detalle_Venta','LWUqF':_0xd4b8b0(0x20f),'sBAIL':_0xd4b8b0(0x234),'ujpqR':_0xd4b8b0(0x228),'vRyTs':_0xd4b8b0(0x21f),'twPqe':_0xd4b8b0(0x192),'uGRax':_0xd4b8b0(0x2a1),'BKEWb':_0xd4b8b0(0x1ef)};try{const {fecha:_0x5d437c}=_0x1175db['query'],_0x365b14=_0x5d437c?new Date(_0x5d437c):new Date(),_0x4623fd=await Ventas[_0xd4b8b0(0x216)]({'where':{'Fecha':{[sequelize['Op'][_0xd4b8b0(0x2cc)]]:[new Date(_0x365b14['setHours'](0x0,0x0,0x0,0x0)),new Date(_0x365b14['setHours'](0x17,0x3b,0x3b,0x3e7))]},'Estado':0x1},'include':[{'model':Detalle_Venta,'as':_0x52a784['jsrdk'],'include':[{'model':Productos,'as':_0x52a784[_0xd4b8b0(0x211)]}]},{'model':Empleados,'as':_0x52a784[_0xd4b8b0(0x23f)],'attributes':[_0x52a784[_0xd4b8b0(0x27c)]]}]}),_0x16b974=_0x4623fd[_0xd4b8b0(0x280)]((_0x5c27be,_0x799ccc)=>_0x5c27be+Number(_0x799ccc[_0xd4b8b0(0x1d3)]),0x0),_0x357fd8=_0x4623fd['length'],_0x2349bd={};_0x4623fd[_0xd4b8b0(0x200)](_0x2bd8a3=>{const _0x29b506=_0xd4b8b0;_0x2bd8a3[_0x29b506(0x2fe)][_0x29b506(0x200)](_0x55d0f5=>{const _0x336d93=_0x29b506,_0x5b91a2=_0x55d0f5[_0x336d93(0x1c4)],_0x15c1b8=_0x55d0f5[_0x336d93(0x20f)]?.[_0x336d93(0x228)]||_0x52a784['MINTD'];!_0x2349bd[_0x5b91a2]&&(_0x2349bd[_0x5b91a2]={'Id_Productos':_0x5b91a2,'Nombre':_0x15c1b8,'Cantidad':0x0,'Total':0x0}),_0x2349bd[_0x5b91a2][_0x336d93(0x1f7)]+=_0x55d0f5[_0x336d93(0x1f7)],_0x2349bd[_0x5b91a2][_0x336d93(0x1d3)]+=_0x52a784[_0x336d93(0x296)](Number,_0x55d0f5[_0x336d93(0x1ca)]);});});const _0x1e77b4=Object[_0xd4b8b0(0x1dc)](_0x2349bd)[_0xd4b8b0(0x1cf)]((_0x2f68c8,_0x5bffd6)=>_0x5bffd6[_0xd4b8b0(0x1d3)]-_0x2f68c8[_0xd4b8b0(0x1d3)])[_0xd4b8b0(0x22a)](0x0,0x5);_0x2c399c[_0xd4b8b0(0x206)]({'status':_0x52a784['vRyTs'],'data':{'fecha':_0x365b14[_0xd4b8b0(0x2c6)]()[_0xd4b8b0(0x2e9)]('T')[0x0],'totalVentas':_0x16b974,'cantidadVentas':_0x357fd8,'productosTop':_0x1e77b4,'ventas':_0x4623fd['map'](_0x2ce7b2=>({'Id_Ventas':_0x2ce7b2[_0xd4b8b0(0x2c4)],'Total':_0x2ce7b2['Total'],'Empleado':_0x2ce7b2[_0xd4b8b0(0x234)]?.[_0xd4b8b0(0x228)],'Fecha':_0x2ce7b2[_0xd4b8b0(0x2db)]}))}});}catch(_0x7baf69){console['error'](_0x52a784[_0xd4b8b0(0x20c)],_0x7baf69),_0x2c399c['status'](0x1f4)[_0xd4b8b0(0x206)]({'status':_0x52a784[_0xd4b8b0(0x284)],'message':_0x52a784[_0xd4b8b0(0x1d1)]});}},exports[a0_0x473939(0x2ac)]=async(_0x43c862,_0x265dec)=>{const _0x56ee37=a0_0x473939,_0x4762bc={'iTuni':_0x56ee37(0x1c8),'rLpWp':function(_0x10d515,_0x35fdfb){return _0x10d515(_0x35fdfb);},'EeidO':function(_0x162ce8,_0x126285){return _0x162ce8-_0x126285;},'IdDsl':function(_0x4935a9,_0x12aa0b){return _0x4935a9(_0x12aa0b);},'ooyKh':function(_0x38ba0b,_0x4f924c){return _0x38ba0b+_0x4f924c;},'qDfEH':_0x56ee37(0x2fe),'ZZfBX':'Id_Productos_Producto','HbMja':_0x56ee37(0x228),'BZvPX':_0x56ee37(0x21f),'ruQKR':function(_0x24686c,_0x11cdc5){return _0x24686c/_0x11cdc5;},'hpsde':_0x56ee37(0x180),'LEkaT':_0x56ee37(0x2a1),'dEyuq':_0x56ee37(0x28b)};try{const {mes:_0x3157cb,año:_0x5a92c1}=_0x43c862[_0x56ee37(0x2ed)],_0x2df899=new Date(),_0x58dd32=_0x3157cb?_0x4762bc[_0x56ee37(0x29b)](_0x4762bc[_0x56ee37(0x2d2)](parseInt,_0x3157cb),0x1):_0x2df899[_0x56ee37(0x208)](),_0x3525d3=_0x5a92c1?parseInt(_0x5a92c1):_0x2df899[_0x56ee37(0x1d2)](),_0x1ac9c1=new Date(_0x3525d3,_0x58dd32,0x1),_0x444fa3=new Date(_0x3525d3,_0x4762bc[_0x56ee37(0x1e5)](_0x58dd32,0x1),0x0,0x17,0x3b,0x3b,0x3e7),_0x1897ce=await Ventas[_0x56ee37(0x216)]({'where':{'Fecha':{[sequelize['Op']['between']]:[_0x1ac9c1,_0x444fa3]},'Estado':0x1},'include':[{'model':Detalle_Venta,'as':_0x4762bc[_0x56ee37(0x2ab)],'include':[{'model':Productos,'as':_0x4762bc['ZZfBX']}]},{'model':Empleados,'as':_0x56ee37(0x234),'attributes':[_0x4762bc[_0x56ee37(0x1ab)]]}]}),_0x53bb4f=_0x1897ce[_0x56ee37(0x280)]((_0x51ed70,_0xe8a61b)=>_0x51ed70+Number(_0xe8a61b['Total']),0x0),_0x396c5d=_0x1897ce[_0x56ee37(0x2e0)],_0x50086e={};_0x1897ce[_0x56ee37(0x200)](_0x4b7045=>{const _0x41fd98=_0x56ee37,_0x2453bc=_0x4b7045['Fecha']['toISOString']()[_0x41fd98(0x2e9)]('T')[0x0];!_0x50086e[_0x2453bc]&&(_0x50086e[_0x2453bc]={'total':0x0,'cantidad':0x0}),_0x50086e[_0x2453bc][_0x41fd98(0x198)]+=Number(_0x4b7045[_0x41fd98(0x1d3)]),_0x50086e[_0x2453bc][_0x41fd98(0x226)]+=0x1;});const _0xa36caf={};_0x1897ce['forEach'](_0x325796=>{const _0x26e670=_0x56ee37,_0x14387d=_0x325796['Id_Empleados'],_0x56c3ae=_0x325796[_0x26e670(0x234)]?.[_0x26e670(0x228)]||_0x4762bc[_0x26e670(0x251)];!_0xa36caf[_0x14387d]&&(_0xa36caf[_0x14387d]={'Id_Empleados':_0x14387d,'Nombre':_0x56c3ae,'Total':0x0,'Cantidad':0x0}),_0xa36caf[_0x14387d]['Total']+=_0x4762bc[_0x26e670(0x214)](Number,_0x325796[_0x26e670(0x1d3)]),_0xa36caf[_0x14387d][_0x26e670(0x1f7)]+=0x1;});const _0x3104ea=Object[_0x56ee37(0x1dc)](_0xa36caf)['sort']((_0x12db96,_0x49dc10)=>_0x49dc10[_0x56ee37(0x1d3)]-_0x12db96[_0x56ee37(0x1d3)])[_0x56ee37(0x22a)](0x0,0x5);_0x265dec['json']({'status':_0x4762bc[_0x56ee37(0x2fc)],'data':{'mes':_0x4762bc['ooyKh'](_0x58dd32,0x1),'año':_0x3525d3,'totalVentas':_0x53bb4f,'cantidadVentas':_0x396c5d,'promedioDiario':_0x4762bc['ruQKR'](_0x396c5d,new Date(_0x3525d3,_0x4762bc[_0x56ee37(0x1e5)](_0x58dd32,0x1),0x0)[_0x56ee37(0x268)]()),'ventasPorDia':_0x50086e,'empleadosTop':_0x3104ea}});}catch(_0xfd444d){console[_0x56ee37(0x2a1)](_0x4762bc[_0x56ee37(0x286)],_0xfd444d),_0x265dec[_0x56ee37(0x1c7)](0x1f4)[_0x56ee37(0x206)]({'status':_0x4762bc[_0x56ee37(0x24a)],'message':_0x4762bc['dEyuq']});}},exports[a0_0x473939(0x2c5)]=async(_0x19f587,_0x49df73)=>{const _0x5e9087=a0_0x473939,_0xe23ce={'JGcxM':function(_0x49c957,_0x344877){return _0x49c957===_0x344877;},'LtIZG':_0x5e9087(0x2a1),'QOjVZ':_0x5e9087(0x2a0),'tnZYI':'ID\x20de\x20producto\x20es\x20requerido\x20para\x20todos\x20los\x20items','TpsfC':'Producto\x20no\x20encontrado','boQuL':function(_0x4e04ce,_0x28b44b){return _0x4e04ce>_0x28b44b;},'uvEoV':function(_0x4b0aff,_0xf8de46){return _0x4b0aff(_0xf8de46);},'EMrUT':'talla','XDHPt':_0x5e9087(0x19f),'gHHne':_0x5e9087(0x2d8),'CKKHO':function(_0x3a8f83,_0x290a7a){return _0x3a8f83>=_0x290a7a;},'ctAdU':'Nombre\x20de\x20tamaño\x20no\x20válido','RydpA':'tamaño','SNPPN':_0x5e9087(0x239),'XuKeh':_0x5e9087(0x292),'zumga':function(_0xe4592c,_0x472979){return _0xe4592c(_0x472979);},'DFTbG':function(_0x2bf81b,_0x2b1bcc){return _0x2bf81b*_0x2b1bcc;},'qBAfF':_0x5e9087(0x279),'eLRaX':function(_0x16996b,_0x4734d1){return _0x16996b(_0x4734d1);},'todjP':'Id_Tallas_Talla','IqTMe':_0x5e9087(0x2e1),'wAeah':_0x5e9087(0x228),'HkDLT':_0x5e9087(0x240),'KTjzp':function(_0x5ecfcc,_0x167b90){return _0x5ecfcc||_0x167b90;},'zrXjU':function(_0x2e0c20,_0x17145c){return _0x2e0c20>=_0x17145c;},'QDyFm':_0x5e9087(0x1ff),'wuJjs':'success','MBAuw':_0x5e9087(0x1f2),'HYCzJ':'Error\x20al\x20validar\x20stock\x20de\x20venta'};try{const {Detalle_Venta:_0x33c352}=_0x19f587[_0x5e9087(0x1b1)];if(!_0x33c352||!Array[_0x5e9087(0x1f1)](_0x33c352)||_0xe23ce['JGcxM'](_0x33c352[_0x5e9087(0x2e0)],0x0))return _0x49df73[_0x5e9087(0x1c7)](0x190)['json']({'status':_0xe23ce[_0x5e9087(0x24e)],'message':_0xe23ce[_0x5e9087(0x26a)]});const _0x56293d=[];let _0x3dc7d2=!![];const _0x32d2e8=[];for(const _0x21815a of _0x33c352){const {Id_Productos:_0x52122e,Cantidad:_0x455c3a,Tallas:_0x4a7d3f,Tamanos:_0xd67b2b}=_0x21815a;if(!_0x52122e){_0x3dc7d2=![],_0x32d2e8[_0x5e9087(0x2d3)](_0xe23ce['tnZYI']);continue;}const _0x4e8cbd=await Productos['findByPk'](_0x52122e);if(!_0x4e8cbd){_0x3dc7d2=![],_0x32d2e8[_0x5e9087(0x2d3)](_0x5e9087(0x19e)+_0x52122e+_0x5e9087(0x30b)),_0x56293d[_0x5e9087(0x2d3)]({'Id_Productos':_0x52122e,'Nombre':_0xe23ce['TpsfC'],'stockDisponible':![],'mensajes':[_0x5e9087(0x19e)+_0x52122e+'\x20no\x20encontrado']});continue;}let _0x1183a8=!![],_0x146cf3=[],_0x42f786=[];if(_0x4a7d3f&&_0xe23ce[_0x5e9087(0x285)](_0x4a7d3f['length'],0x0))for(const _0x25ee68 of _0x4a7d3f){const _0x129b1e=_0x25ee68[_0x5e9087(0x2dd)]||_0x25ee68[_0x5e9087(0x1b3)]||_0x25ee68[_0x5e9087(0x1db)]||'',_0x36dcab=_0xe23ce[_0x5e9087(0x205)](Number,_0x25ee68[_0x5e9087(0x226)]||_0x25ee68[_0x5e9087(0x1f7)]||0x0);if(!_0x129b1e){_0x1183a8=![],_0x3dc7d2=![],_0x146cf3['push'](_0x5e9087(0x199)+_0x4e8cbd['Nombre']),_0x42f786[_0x5e9087(0x2d3)]({'tipo':_0xe23ce[_0x5e9087(0x264)],'nombre':_0xe23ce[_0x5e9087(0x21e)],'disponible':0x0,'solicitado':0x0,'suficiente':![],'error':'Nombre\x20de\x20talla\x20no\x20válido'});continue;}const _0x3e46bc=await _0x4a7d3f['findOne']({'where':{'Nombre':_0x129b1e}});if(!_0x3e46bc){_0x1183a8=![],_0x3dc7d2=![],_0x146cf3[_0x5e9087(0x2d3)](_0x5e9087(0x1f4)+_0x129b1e+_0x5e9087(0x2a4)),_0x42f786[_0x5e9087(0x2d3)]({'tipo':_0xe23ce[_0x5e9087(0x264)],'nombre':_0x129b1e,'disponible':0x0,'solicitado':_0x36dcab,'suficiente':![],'error':_0xe23ce[_0x5e9087(0x265)]});continue;}const _0x5566d0=await Producto_Tallas[_0x5e9087(0x1fa)]({'where':{'Id_Productos':_0x4e8cbd[_0x5e9087(0x1c4)],'Id_Tallas':_0x3e46bc['Id_Tallas']}}),_0x9a7e3a=_0xe23ce[_0x5e9087(0x205)](Number,_0x5566d0?.['Stock']||0x0),_0x2d8894=_0xe23ce[_0x5e9087(0x187)](_0x9a7e3a,_0x36dcab);!_0x2d8894&&(_0x1183a8=![],_0x3dc7d2=![],_0x146cf3[_0x5e9087(0x2d3)](_0x5e9087(0x201)+_0x129b1e+_0x5e9087(0x2a6)+_0x9a7e3a+',\x20solicitado\x20'+_0x36dcab)),_0x42f786['push']({'tipo':_0xe23ce[_0x5e9087(0x264)],'nombre':_0x129b1e,'disponible':_0x9a7e3a,'solicitado':_0x36dcab,'suficiente':_0x2d8894});}if(_0xd67b2b&&_0xd67b2b[_0x5e9087(0x2e0)]>0x0)for(const _0x375035 of _0xd67b2b){const _0x258d68=_0x375035[_0x5e9087(0x1db)]||_0x375035[_0x5e9087(0x228)]||'';if(!_0x258d68){_0x1183a8=![],_0x3dc7d2=![],_0x146cf3['push']('Nombre\x20de\x20tamaño\x20no\x20válido\x20para\x20el\x20producto\x20'+_0x4e8cbd[_0x5e9087(0x228)]),_0x42f786[_0x5e9087(0x2d3)]({'tipo':'tamaño','nombre':_0xe23ce[_0x5e9087(0x21e)],'disponible':0x0,'solicitado':0x0,'suficiente':![],'error':_0xe23ce[_0x5e9087(0x307)]});continue;}const _0x3f956e=await Tamano['findOne']({'where':{'Nombre':_0x258d68}});if(!_0x3f956e){_0x1183a8=![],_0x3dc7d2=![],_0x146cf3[_0x5e9087(0x2d3)](_0x5e9087(0x2dc)+_0x258d68+_0x5e9087(0x30b)),_0x42f786[_0x5e9087(0x2d3)]({'tipo':_0xe23ce[_0x5e9087(0x1ed)],'nombre':_0x258d68,'disponible':0x0,'solicitado':0x0,'suficiente':![],'error':_0x5e9087(0x247)});continue;}const _0x492ea8=await Producto_Tamano[_0x5e9087(0x1fa)]({'where':{'Id_Productos':_0x4e8cbd[_0x5e9087(0x1c4)],'Id_Tamano':_0x3f956e['Id_Tamano']}});if(!_0x492ea8){_0x1183a8=![],_0x3dc7d2=![],_0x146cf3[_0x5e9087(0x2d3)](_0x5e9087(0x18d)+_0x4e8cbd[_0x5e9087(0x228)]+_0x5e9087(0x231)+_0x258d68+_0x5e9087(0x2f8)),_0x42f786[_0x5e9087(0x2d3)]({'tipo':_0xe23ce[_0x5e9087(0x1ed)],'nombre':_0x258d68,'disponible':0x0,'solicitado':0x0,'suficiente':![],'error':_0xe23ce[_0x5e9087(0x25b)]});continue;}const _0x23d924=await Producto_Tamano_Insumos[_0x5e9087(0x216)]({'where':{'Id_Producto_Tamano':_0x492ea8['Id_Producto_Tamano']},'include':[{'model':Insumos,'as':_0xe23ce[_0x5e9087(0x276)]}]}),_0x285d23=await Tamano_Insumos[_0x5e9087(0x216)]({'where':{'Id_Tamano':_0x3f956e[_0x5e9087(0x224)]},'include':[{'model':Insumos,'as':_0xe23ce[_0x5e9087(0x276)]}]}),_0x31cf1c=_0xe23ce[_0x5e9087(0x182)](Number,_0x375035[_0x5e9087(0x1f7)]||_0x375035['cantidad']||0x0);let _0x59a764=!![];const _0x17e25f=[],_0xb13b1e=new Map();for(const _0x16bd5b of _0x23d924){const _0x144a53=_0x16bd5b['Id_Insumos_Insumo'],_0x1365f2=_0xe23ce[_0x5e9087(0x182)](Number,_0x16bd5b[_0x5e9087(0x1b5)]||0x0),_0x3d6b34=_0xe23ce[_0x5e9087(0x2b0)](_0x1365f2,_0x31cf1c),_0x1ed883=Number(_0x144a53[_0x5e9087(0x25d)]||0x0),_0x23f758=_0xe23ce[_0x5e9087(0x187)](_0x1ed883,_0x3d6b34);!_0x23f758&&(_0x59a764=![],_0x1183a8=![],_0x3dc7d2=![],_0x146cf3[_0x5e9087(0x2d3)](_0x5e9087(0x278)+_0x144a53[_0x5e9087(0x228)]+_0x5e9087(0x25f)+_0x1ed883+_0x5e9087(0x273)+_0x3d6b34)),_0x17e25f[_0x5e9087(0x2d3)]({'insumo':_0x144a53[_0x5e9087(0x228)],'disponible':_0x1ed883,'necesario':_0x3d6b34,'suficiente':_0x23f758,'tipo':_0xe23ce[_0x5e9087(0x1e3)]}),_0xb13b1e[_0x5e9087(0x19a)](_0x144a53['Id_Insumos'],!![]);}for(const _0x1d0307 of _0x285d23){const _0x262a17=_0x1d0307[_0x5e9087(0x292)];if(_0xb13b1e[_0x5e9087(0x272)](_0x262a17[_0x5e9087(0x22b)]))continue;const _0x168b65=_0xe23ce[_0x5e9087(0x245)](Number,_0x1d0307[_0x5e9087(0x1f7)]||0x0),_0x55a29d=_0x168b65*_0x31cf1c,_0x584949=_0xe23ce[_0x5e9087(0x205)](Number,_0x262a17[_0x5e9087(0x25d)]||0x0),_0x52c2c8=_0xe23ce[_0x5e9087(0x187)](_0x584949,_0x55a29d);!_0x52c2c8&&(_0x59a764=![],_0x1183a8=![],_0x3dc7d2=![],_0x146cf3[_0x5e9087(0x2d3)](_0x5e9087(0x2b8)+_0x262a17['Nombre']+_0x5e9087(0x25f)+_0x584949+_0x5e9087(0x273)+_0x55a29d)),_0x17e25f[_0x5e9087(0x2d3)]({'insumo':_0x262a17[_0x5e9087(0x228)],'disponible':_0x584949,'necesario':_0x55a29d,'suficiente':_0x52c2c8,'tipo':_0x5e9087(0x21a)});}_0x42f786[_0x5e9087(0x2d3)]({'tipo':_0x5e9087(0x219),'nombre':_0x258d68,'cantidad':_0x31cf1c,'insumos':_0x17e25f,'suficiente':_0x59a764});}if((!_0x4a7d3f||_0xe23ce[_0x5e9087(0x2fa)](_0x4a7d3f[_0x5e9087(0x2e0)],0x0))&&(!_0xd67b2b||_0xe23ce['JGcxM'](_0xd67b2b[_0x5e9087(0x2e0)],0x0))){const _0x4f3cc7=await Producto_Tallas[_0x5e9087(0x216)]({'where':{'Id_Productos':_0x4e8cbd[_0x5e9087(0x1c4)]},'include':[{'model':_0x4a7d3f,'as':_0xe23ce[_0x5e9087(0x1cb)],'attributes':[_0xe23ce[_0x5e9087(0x2f9)],_0xe23ce['wAeah']]}]});if(_0x4f3cc7&&_0xe23ce[_0x5e9087(0x285)](_0x4f3cc7['length'],0x0))_0x1183a8=![],_0x3dc7d2=![],_0x146cf3['push'](_0x5e9087(0x18d)+_0x4e8cbd[_0x5e9087(0x228)]+_0x5e9087(0x2b1)+_0x4f3cc7['map'](_0x300257=>_0x300257[_0x5e9087(0x306)]?.[_0x5e9087(0x228)]||_0x5e9087(0x19f))[_0x5e9087(0x256)](',\x20')),_0x42f786[_0x5e9087(0x2d3)]({'tipo':_0xe23ce[_0x5e9087(0x24e)],'nombre':_0x4e8cbd[_0x5e9087(0x228)],'disponible':0x0,'solicitado':0x0,'suficiente':![],'error':_0xe23ce[_0x5e9087(0x2ba)]});else{const _0x2854b6=Number(_0x4e8cbd[_0x5e9087(0x25d)]||0x0),_0x5cca21=Number(_0xe23ce[_0x5e9087(0x308)](_0x455c3a,0x0)),_0x3ac94a=_0xe23ce[_0x5e9087(0x2ad)](_0x2854b6,_0x5cca21);!_0x3ac94a&&(_0x1183a8=![],_0x3dc7d2=![],_0x146cf3[_0x5e9087(0x2d3)]('Stock\x20insuficiente\x20para\x20el\x20producto\x20'+_0x4e8cbd[_0x5e9087(0x228)]+_0x5e9087(0x25f)+_0x2854b6+_0x5e9087(0x1bb)+_0x5cca21)),_0x42f786[_0x5e9087(0x2d3)]({'tipo':_0xe23ce['QDyFm'],'nombre':_0x4e8cbd[_0x5e9087(0x228)],'disponible':_0x2854b6,'solicitado':_0x5cca21,'suficiente':_0x3ac94a});}}_0x56293d[_0x5e9087(0x2d3)]({'Id_Productos':_0x4e8cbd[_0x5e9087(0x1c4)],'Nombre':_0x4e8cbd[_0x5e9087(0x228)],'stockDisponible':_0x1183a8,'mensajes':_0x146cf3,'detallesStock':_0x42f786});}_0x49df73[_0x5e9087(0x206)]({'status':_0xe23ce[_0x5e9087(0x2d7)],'data':{'ventaValida':_0x3dc7d2,'mensajesGenerales':_0x32d2e8,'resultados':_0x56293d}});}catch(_0x4035b5){console[_0x5e9087(0x2a1)](_0xe23ce[_0x5e9087(0x312)],_0x4035b5),_0x49df73[_0x5e9087(0x1c7)](0x1f4)[_0x5e9087(0x206)]({'status':_0xe23ce[_0x5e9087(0x24e)],'message':_0xe23ce['HYCzJ']});}},exports[a0_0x473939(0x190)]=async(_0xe8b1b3,_0x2e4d40)=>{const _0x1b1169=a0_0x473939,_0x3f7175={'TVOFj':'ID\x20de\x20producto\x20es\x20requerido','xXDYC':_0x1b1169(0x2a1),'cQsha':_0x1b1169(0x306),'MsGzv':_0x1b1169(0x2e1),'EFmtH':'Nombre','oPDxX':_0x1b1169(0x21f),'VLUiV':function(_0x186dc5,_0x17e12f){return _0x186dc5>_0x17e12f;},'pfkjM':'Error\x20al\x20obtener\x20tallas\x20del\x20producto'};try{const {Id_Productos:_0x336a84}=_0xe8b1b3[_0x1b1169(0x2ce)];if(!_0x336a84)return _0x2e4d40[_0x1b1169(0x1c7)](0x190)['json']({'status':_0x1b1169(0x2a1),'message':_0x3f7175[_0x1b1169(0x263)]});const _0x4e539f=await Productos['findByPk'](_0x336a84);if(!_0x4e539f)return _0x2e4d40[_0x1b1169(0x1c7)](0x194)[_0x1b1169(0x206)]({'status':_0x3f7175['xXDYC'],'message':_0x1b1169(0x1c1)});const _0x2b14dd=await Producto_Tallas[_0x1b1169(0x216)]({'where':{'Id_Productos':_0x336a84},'include':[{'model':Tallas,'as':_0x3f7175[_0x1b1169(0x19d)],'attributes':[_0x3f7175[_0x1b1169(0x29c)],_0x3f7175['EFmtH']]}]}),_0x33467f=_0x2b14dd[_0x1b1169(0x196)](_0x21828a=>({'Id_Producto_Tallas':_0x21828a[_0x1b1169(0x249)],'Id_Tallas':_0x21828a[_0x1b1169(0x2e1)],'Nombre_Talla':_0x21828a[_0x1b1169(0x306)]?.[_0x1b1169(0x228)]||_0x1b1169(0x19f),'Stock':_0x21828a[_0x1b1169(0x25d)],'Precio':_0x21828a['Precio']||0x0}));_0x2e4d40[_0x1b1169(0x206)]({'status':_0x3f7175['oPDxX'],'data':{'Id_Productos':_0x4e539f[_0x1b1169(0x1c4)],'Nombre':_0x4e539f[_0x1b1169(0x228)],'tieneTallas':_0x3f7175[_0x1b1169(0x1bc)](_0x33467f[_0x1b1169(0x2e0)],0x0),'tallasDisponibles':_0x33467f,'totalTallas':_0x33467f[_0x1b1169(0x2e0)]}});}catch(_0x5d1cfe){console['error']('Error\x20al\x20obtener\x20tallas\x20del\x20producto:',_0x5d1cfe),_0x2e4d40[_0x1b1169(0x1c7)](0x1f4)[_0x1b1169(0x206)]({'status':_0x3f7175['xXDYC'],'message':_0x3f7175['pfkjM']});}},exports[a0_0x473939(0x2e5)]=async(_0x57d696,_0x555e5b)=>{const _0x20e0f6=a0_0x473939,_0x3be420={'xzbkA':'error','vblQE':_0x20e0f6(0x2b4),'NAyKs':_0x20e0f6(0x27d),'aXiTd':_0x20e0f6(0x228),'WkWEH':_0x20e0f6(0x23c),'LiFEU':_0x20e0f6(0x22f),'KTYlN':'Producto_Tamano_Insumos','XWduk':_0x20e0f6(0x22b),'LcYNq':_0x20e0f6(0x25d),'jlgDA':_0x20e0f6(0x2fb),'UAmMq':_0x20e0f6(0x21f),'YFcwW':function(_0x1e4da2,_0x1fd2f0){return _0x1e4da2>_0x1fd2f0;},'axDkC':'Error\x20al\x20obtener\x20tamaños\x20del\x20producto:'};try{const {Id_Productos:_0x70ad06}=_0x57d696[_0x20e0f6(0x2ce)];if(!_0x70ad06)return _0x555e5b['status'](0x190)[_0x20e0f6(0x206)]({'status':_0x3be420[_0x20e0f6(0x230)],'message':_0x3be420[_0x20e0f6(0x266)]});const _0x13c3e8=await Productos[_0x20e0f6(0x277)](_0x70ad06);if(!_0x13c3e8)return _0x555e5b[_0x20e0f6(0x1c7)](0x194)['json']({'status':_0x20e0f6(0x2a1),'message':'Producto\x20no\x20encontrado'});const _0x4a4e8d=await Producto_Tamano[_0x20e0f6(0x216)]({'where':{'Id_Productos':_0x70ad06},'include':[{'model':Tamano,'as':_0x3be420[_0x20e0f6(0x1a6)],'attributes':[_0x20e0f6(0x224),_0x3be420['aXiTd'],_0x3be420[_0x20e0f6(0x29f)],_0x3be420['LiFEU']]},{'model':Producto_Tamano_Insumos,'as':_0x3be420[_0x20e0f6(0x293)],'include':[{'model':Insumos,'as':_0x20e0f6(0x292),'attributes':[_0x3be420[_0x20e0f6(0x253)],_0x3be420[_0x20e0f6(0x25c)],_0x3be420[_0x20e0f6(0x20e)],_0x3be420['jlgDA']]}]}]}),_0x220b47=_0x4a4e8d['map'](_0x43f9fe=>({'Id_Producto_Tamano':_0x43f9fe[_0x20e0f6(0x2d5)],'Id_Tamano':_0x43f9fe['Id_Tamano'],'nombre':_0x43f9fe[_0x20e0f6(0x27d)]?.[_0x20e0f6(0x228)]||_0x20e0f6(0x19f),'precio':_0x43f9fe['Id_Tamano_Tamano']?.[_0x20e0f6(0x22f)]?.[_0x20e0f6(0x204)]()||'0','Cantidad_Maxima':_0x43f9fe[_0x20e0f6(0x27d)]?.[_0x20e0f6(0x23c)]||0x0,'insumos':_0x43f9fe['Producto_Tamano_Insumos']?.[_0x20e0f6(0x196)](_0x1a3875=>({'Id_Insumo':_0x1a3875['Id_Insumos_Insumo']?.['Id_Insumos'],'Nombre':_0x1a3875[_0x20e0f6(0x292)]?.[_0x20e0f6(0x228)]||_0x20e0f6(0x19f),'Stock':_0x1a3875[_0x20e0f6(0x292)]?.['Stock']||0x0,'Cantidad_Consumo':_0x1a3875['Cantidad_Consumo']||0x0,'Unidad_Medida':_0x1a3875[_0x20e0f6(0x292)]?.[_0x20e0f6(0x2fb)]||_0x20e0f6(0x19f)}))||[]}));_0x555e5b[_0x20e0f6(0x206)]({'status':_0x3be420[_0x20e0f6(0x1cd)],'data':{'Id_Productos':_0x13c3e8[_0x20e0f6(0x1c4)],'Nombre':_0x13c3e8[_0x20e0f6(0x228)],'tieneTamanos':_0x3be420[_0x20e0f6(0x2b2)](_0x220b47[_0x20e0f6(0x2e0)],0x0),'tamanosDisponibles':_0x220b47,'totalTamanos':_0x220b47['length']}});}catch(_0x323ca7){console[_0x20e0f6(0x2a1)](_0x3be420[_0x20e0f6(0x19c)],_0x323ca7),_0x555e5b[_0x20e0f6(0x1c7)](0x1f4)['json']({'status':_0x3be420[_0x20e0f6(0x230)],'message':'Error\x20al\x20obtener\x20tamaños\x20del\x20producto'});}},exports[a0_0x473939(0x1fd)]=async(_0x2e1ec6,_0x32a524)=>{const _0x238bff=a0_0x473939,_0x4556ec={'ifnVy':_0x238bff(0x2a1),'lgVBR':_0x238bff(0x1c3),'DgtMb':'Tamano_Insumos','CqUbH':_0x238bff(0x292),'ThhrG':_0x238bff(0x228),'qncEQ':_0x238bff(0x25d),'Btarr':_0x238bff(0x21f),'DbcBv':'Error\x20al\x20obtener\x20tamaño\x20por\x20nombre:','lUSEg':'Error\x20al\x20obtener\x20tamaño\x20por\x20nombre'};try{const {nombreTamano:_0x7767df}=_0x2e1ec6['params'];if(!_0x7767df)return _0x32a524[_0x238bff(0x1c7)](0x190)[_0x238bff(0x206)]({'status':_0x4556ec['ifnVy'],'message':_0x4556ec[_0x238bff(0x26d)]});const _0x511864=await Tamano[_0x238bff(0x1fa)]({'where':{'Nombre':_0x7767df},'include':[{'model':Tamano_Insumos,'as':_0x4556ec['DgtMb'],'include':[{'model':Insumos,'as':_0x4556ec[_0x238bff(0x2ff)],'attributes':[_0x238bff(0x22b),_0x4556ec[_0x238bff(0x185)],_0x4556ec[_0x238bff(0x223)],_0x238bff(0x2fb)]}]}]});if(!_0x511864)return _0x32a524[_0x238bff(0x1c7)](0x194)[_0x238bff(0x206)]({'status':_0x4556ec[_0x238bff(0x28e)],'message':_0x238bff(0x2dc)+_0x7767df+_0x238bff(0x30b)});const _0x4f4a52={'Id_Tamano':_0x511864[_0x238bff(0x224)],'nombre':_0x511864[_0x238bff(0x228)],'precio':_0x511864[_0x238bff(0x22f)]?.[_0x238bff(0x204)]()||'0','Cantidad_Maxima':_0x511864[_0x238bff(0x23c)],'Estado':_0x511864[_0x238bff(0x1aa)],'insumos':_0x511864['Tamano_Insumos']?.['map'](_0x2951e6=>({'Id_Insumo':_0x2951e6[_0x238bff(0x292)]?.[_0x238bff(0x22b)],'Nombre':_0x2951e6['Id_Insumos_Insumo']?.[_0x238bff(0x228)]||_0x238bff(0x19f),'Stock':_0x2951e6[_0x238bff(0x292)]?.[_0x238bff(0x25d)]||0x0,'Cantidad':_0x2951e6['Cantidad']||0x0,'Unidad_Medida':_0x2951e6[_0x238bff(0x292)]?.[_0x238bff(0x2fb)]||_0x238bff(0x19f)}))||[]};_0x32a524[_0x238bff(0x206)]({'status':_0x4556ec[_0x238bff(0x1a0)],'data':_0x4f4a52});}catch(_0x2bd891){console['error'](_0x4556ec[_0x238bff(0x22d)],_0x2bd891),_0x32a524[_0x238bff(0x1c7)](0x1f4)[_0x238bff(0x206)]({'status':_0x4556ec[_0x238bff(0x28e)],'message':_0x4556ec[_0x238bff(0x2de)]});}},exports[a0_0x473939(0x303)]=async(_0x1e130e,_0x44cc39)=>{const _0xba196b=a0_0x473939,_0x5323b9={'nEZFH':'Sin\x20Categoría','SWElj':'error','LftPV':_0xba196b(0x1c1),'dGoeP':_0xba196b(0x27d),'RuBPN':_0xba196b(0x23c),'PRujF':_0xba196b(0x22f),'RbxTI':_0xba196b(0x269),'cACTw':_0xba196b(0x292),'NFKOk':_0xba196b(0x228),'TDXud':_0xba196b(0x2fb),'UCDTq':_0xba196b(0x21f),'UxfIM':function(_0x1576b8,_0x525aa1){return _0x1576b8>_0x525aa1;},'BlmTn':function(_0x502ae9,_0x11e430){return _0x502ae9/_0x11e430;},'cgXMf':function(_0x45201f,_0x3ddfe5){return _0x45201f>_0x3ddfe5;},'jSEcr':_0xba196b(0x246),'WsaII':'Error\x20al\x20verificar\x20configuración\x20de\x20insumos\x20del\x20producto'};try{const {Id_Productos:_0x4e1fb4}=_0x1e130e['params'];if(!_0x4e1fb4)return _0x44cc39['status'](0x190)[_0xba196b(0x206)]({'status':_0x5323b9['SWElj'],'message':_0xba196b(0x2b4)});const _0x10643c=await Productos['findByPk'](_0x4e1fb4);if(!_0x10643c)return _0x44cc39[_0xba196b(0x1c7)](0x194)[_0xba196b(0x206)]({'status':_0x5323b9[_0xba196b(0x2a9)],'message':_0x5323b9[_0xba196b(0x2d1)]});const _0x5c3b7a=await Producto_Tamano['findAll']({'where':{'Id_Productos':_0x4e1fb4},'include':[{'model':Tamano,'as':_0x5323b9[_0xba196b(0x2f2)],'attributes':['Id_Tamano','Nombre',_0x5323b9['RuBPN'],_0x5323b9[_0xba196b(0x259)]]},{'model':Producto_Tamano_Insumos,'as':_0x5323b9[_0xba196b(0x20a)],'include':[{'model':Insumos,'as':_0x5323b9[_0xba196b(0x287)],'attributes':['Id_Insumos',_0x5323b9[_0xba196b(0x2f1)],_0xba196b(0x25d),_0x5323b9[_0xba196b(0x1a1)],_0xba196b(0x235)]}]}]}),_0x29f114=_0x5c3b7a[_0xba196b(0x196)](_0x385baf=>{const _0x3ece6f=_0xba196b,_0x107095={'Wzqwu':_0x5323b9[_0x3ece6f(0x218)]},_0x263a4f=_0x385baf['Producto_Tamano_Insumos']?.[_0x3ece6f(0x196)](_0x3bc6dc=>({'Id_Insumo':_0x3bc6dc['Id_Insumos_Insumo']?.['Id_Insumos'],'Nombre':_0x3bc6dc[_0x3ece6f(0x292)]?.[_0x3ece6f(0x228)]||_0x3ece6f(0x19f),'Stock':_0x3bc6dc[_0x3ece6f(0x292)]?.[_0x3ece6f(0x25d)]||0x0,'Cantidad_Consumo':_0x3bc6dc[_0x3ece6f(0x1b5)]||0x0,'Unidad_Medida':_0x3bc6dc['Id_Insumos_Insumo']?.[_0x3ece6f(0x2fb)]||'N/A','Id_Categoria':_0x3bc6dc[_0x3ece6f(0x292)]?.[_0x3ece6f(0x235)]||_0x3ece6f(0x19f)}))||[];return{'Id_Producto_Tamano':_0x385baf[_0x3ece6f(0x2d5)],'Id_Tamano':_0x385baf['Id_Tamano'],'Nombre_Tamano':_0x385baf[_0x3ece6f(0x27d)]?.[_0x3ece6f(0x228)]||'N/A','Cantidad_Maxima':_0x385baf[_0x3ece6f(0x27d)]?.[_0x3ece6f(0x23c)]||0x0,'Precio_Venta':_0x385baf[_0x3ece6f(0x27d)]?.[_0x3ece6f(0x22f)]||0x0,'Total_Insumos':_0x263a4f[_0x3ece6f(0x2e0)],'Insumos':_0x263a4f,'Insumos_Por_Categoria':_0x263a4f[_0x3ece6f(0x280)]((_0xa38107,_0x2e206a)=>{const _0x50878a=_0x3ece6f,_0x3ad5d5=_0x2e206a['Id_Categoria']||_0x107095[_0x50878a(0x2a2)];return!_0xa38107[_0x3ad5d5]&&(_0xa38107[_0x3ad5d5]=[]),_0xa38107[_0x3ad5d5]['push'](_0x2e206a),_0xa38107;},{})};}),_0x5c3073=_0x29f114['length'],_0x374985=_0x29f114[_0xba196b(0x280)]((_0x1c0560,_0x118abd)=>_0x1c0560+_0x118abd[_0xba196b(0x2f6)],0x0),_0x4e2014=_0x29f114['filter'](_0x10c87f=>_0x10c87f['Total_Insumos']===0x0);_0x44cc39[_0xba196b(0x206)]({'status':_0x5323b9[_0xba196b(0x23e)],'message':_0xba196b(0x2c1)+_0x10643c['Nombre'],'data':{'Id_Productos':_0x10643c[_0xba196b(0x1c4)],'Nombre_Producto':_0x10643c[_0xba196b(0x228)],'Resumen':{'Total_Tamanos':_0x5c3073,'Total_Insumos_Configurados':_0x374985,'Tamanos_Sin_Insumos':_0x4e2014[_0xba196b(0x2e0)],'Promedio_Insumos_Por_Tamaño':_0x5323b9[_0xba196b(0x1c0)](_0x5c3073,0x0)?_0x5323b9[_0xba196b(0x1c9)](_0x374985,_0x5c3073)[_0xba196b(0x21d)](0x2):0x0},'Configuracion_Completa':_0x29f114,'Alertas':_0x5323b9[_0xba196b(0x17e)](_0x4e2014[_0xba196b(0x2e0)],0x0)?[_0x4e2014['length']+_0xba196b(0x221)+_0x4e2014[_0xba196b(0x196)](_0x6837f4=>_0x6837f4[_0xba196b(0x2c8)])['join'](',\x20')]:[]}});}catch(_0x1dbc08){console[_0xba196b(0x2a1)](_0x5323b9[_0xba196b(0x215)],_0x1dbc08),_0x44cc39[_0xba196b(0x1c7)](0x1f4)[_0xba196b(0x206)]({'status':_0x5323b9[_0xba196b(0x2a9)],'message':_0x5323b9[_0xba196b(0x2c3)],'detail':_0x1dbc08['message']});}},exports[a0_0x473939(0x1b6)]=async(_0x54c763,_0x310aea)=>{const _0xc6fce1=a0_0x473939,_0x2a60f1={'gSbgj':function(_0x3ebdf2,_0x3905da){return _0x3ebdf2+_0x3905da;},'MshSC':_0xc6fce1(0x2a1),'Cbafr':_0xc6fce1(0x21f),'RXMAx':_0xc6fce1(0x2e6)};try{const {Id_Productos:_0x47ffe7,nombreTamano:_0x6168ba}=_0x54c763[_0xc6fce1(0x2ce)],_0x45146e=await Tamano[_0xc6fce1(0x1fa)]({'where':{'Nombre':_0x6168ba}});if(!_0x45146e)return _0x310aea[_0xc6fce1(0x1c7)](0x194)[_0xc6fce1(0x206)]({'status':_0x2a60f1[_0xc6fce1(0x227)],'message':'Tamaño\x20'+_0x6168ba+_0xc6fce1(0x30b)});const _0x1f47a3=await Producto_Tamano[_0xc6fce1(0x1fa)]({'where':{'Id_Productos':_0x47ffe7,'Id_Tamano':_0x45146e[_0xc6fce1(0x224)]}});if(!_0x1f47a3)return _0x310aea[_0xc6fce1(0x1c7)](0x194)['json']({'status':_0xc6fce1(0x2a1),'message':'No\x20se\x20encontró\x20la\x20relación\x20producto-tamaño\x20para\x20'+_0x6168ba});const _0x4940b3=await Producto_Tamano_Insumos[_0xc6fce1(0x216)]({'where':{'Id_Producto_Tamano':_0x1f47a3['Id_Producto_Tamano']},'include':[{'model':Insumos,'as':_0xc6fce1(0x292),'required':!![]}]}),_0x1ca7ca=_0x4940b3[_0xc6fce1(0x196)]((_0x3495e5,_0x4b5349)=>{const _0x23c3d5=_0xc6fce1,_0x2211c2={'index':_0x2a60f1[_0x23c3d5(0x18b)](_0x4b5349,0x1),'Id_Insumo':_0x3495e5[_0x23c3d5(0x292)][_0x23c3d5(0x22b)],'Nombre':_0x3495e5['Id_Insumos_Insumo'][_0x23c3d5(0x228)],'Cantidad_Consumo':_0x3495e5[_0x23c3d5(0x1b5)],'Stock_Actual':_0x3495e5[_0x23c3d5(0x292)][_0x23c3d5(0x25d)]};return _0x2211c2;}),_0x5ab6fe={'status':_0x2a60f1[_0xc6fce1(0x194)],'producto_id':_0x47ffe7,'tamano':{'nombre':_0x45146e[_0xc6fce1(0x228)],'id':_0x45146e[_0xc6fce1(0x224)],'cantidad_maxima':_0x45146e[_0xc6fce1(0x23c)],'precio_venta':_0x45146e[_0xc6fce1(0x22f)]},'insumos_configurados':_0x1ca7ca,'total_insumos':_0x4940b3[_0xc6fce1(0x2e0)]};return _0x310aea[_0xc6fce1(0x206)](_0x5ab6fe);}catch(_0x5b2ec6){return console[_0xc6fce1(0x2a1)](_0x2a60f1[_0xc6fce1(0x24f)],_0x5b2ec6),_0x310aea[_0xc6fce1(0x1c7)](0x1f4)[_0xc6fce1(0x206)]({'status':_0x2a60f1[_0xc6fce1(0x227)],'message':_0x5b2ec6[_0xc6fce1(0x1b0)]});}};